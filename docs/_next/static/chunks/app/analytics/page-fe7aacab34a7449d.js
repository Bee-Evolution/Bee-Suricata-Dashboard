(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{29735:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>W});var r=a(95155),s=a(76530),i=a(97322),n=a(80851),o=a(23315),l=a(28548),c=a(41983),d=a(33077),h=a(61259),u=a(12115),p=a(26991),g=a(80019),x=a(68425),y=a(47734),m=a(73697),A=a(33420),b=a(57095),f=a(12723),v=a(4035),j=a(69386),B=a(98128),w=a(58155),k=a(36300),F=a(46368),S=a(36697);let D=(0,S.A)((0,r.jsx)("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}),"TrendingUp"),C=(0,S.A)((0,r.jsx)("path",{d:"m16 18 2.29-2.29-4.88-4.88-4 4L2 7.41 3.41 6l6 6 4-4 6.3 6.29L22 12v6z"}),"TrendingDown"),I=(0,S.A)((0,r.jsx)("path",{d:"m22 12-4-4v3H3v2h15v3z"}),"TrendingFlat");var R=a(29767),_=a(84578);let L=t=>{let{label:e,value:a,icon:s,trend:i,trendValue:c,color:d="#FFD600",subtitle:h,compact:u=!1}=t,p=()=>{switch(i){case"up":return"#4CAF50";case"down":return"#F44336";case"stable":return"#FFD600";default:return"#B0B0B0"}};return(0,r.jsx)(R.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:2,height:"100%",transition:"all 0.2s ease-in-out","&:hover":{borderColor:d,transform:"translateY(-2px)",boxShadow:"0 4px 20px ".concat(d,"20")}},children:(0,r.jsxs)(_.A,{sx:{p:u?2:3,height:"100%",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[(0,r.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[s&&(0,r.jsx)(o.A,{sx:{fontSize:u?"1.5rem":"2rem",lineHeight:1},children:s}),(0,r.jsx)(o.A,{variant:u?"body2":"body1",sx:{color:"#B0B0B0",fontWeight:500,lineHeight:1.2},children:e})]}),i&&c&&(0,r.jsx)(l.A,{icon:(()=>{switch(i){case"up":return(0,r.jsx)(D,{sx:{color:"#4CAF50",fontSize:"1rem"}});case"down":return(0,r.jsx)(C,{sx:{color:"#F44336",fontSize:"1rem"}});case"stable":return(0,r.jsx)(I,{sx:{color:"#FFD600",fontSize:"1rem"}});default:return(0,r.jsx)(I,{sx:{color:"#B0B0B0",fontSize:"1rem"}})}})(),label:c,size:"small",sx:{backgroundColor:"".concat(p(),"20"),color:p(),border:"1px solid ".concat(p(),"40"),fontSize:"0.7rem",height:"24px"}})]}),(0,r.jsx)(n.A,{sx:{flex:1,display:"flex",alignItems:"center"},children:(0,r.jsx)(o.A,{variant:u?"h5":"h4",sx:{color:d,fontWeight:700,lineHeight:1,fontSize:u?"1.5rem":"2rem"},children:"number"==typeof a?a.toLocaleString():a})}),h&&(0,r.jsx)(o.A,{variant:"caption",sx:{color:"#B0B0B0",mt:1,display:"block"},children:h})]})})};var P=a(75183);let U=["#FFD600","#FF6B6B","#FF8C42","#FFB347","#FFA500","#FF7F50"];function W(){let[t,e]=(0,u.useState)(null),[a,S]=(0,u.useState)(!0),[D,C]=(0,u.useState)(null),I=(0,u.useCallback)(async()=>{try{var t,a,r,s;S(!0),C(null);let i=await P.A.getAnalytics("7days"),n={...i.data,high_alerts:(null==(a=i.data.severity_breakdown)||null==(t=a.find(t=>"high"===t.severity))?void 0:t.count)||0,medium_alerts:(null==(s=i.data.severity_breakdown)||null==(r=s.find(t=>"medium"===t.severity))?void 0:r.count)||0};e(n)}catch(t){console.error("Failed to fetch analytics:",t),C("Failed to load analytics data. Please check your connection.")}finally{S(!1)}},[]);return((0,u.useEffect)(()=>{I();let t=setInterval(I,3e4);return()=>clearInterval(t)},[I]),a)?(0,r.jsx)(k.b,{children:(0,r.jsx)(F.A,{children:(0,r.jsx)(i.A,{maxWidth:"xl",sx:{py:4},children:(0,r.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:(0,r.jsx)(o.A,{variant:"h6",sx:{color:"#FFD600"},children:"\uD83D\uDCCA Loading Security Analytics..."})})})})}):D?(0,r.jsx)(k.b,{children:(0,r.jsx)(F.A,{children:(0,r.jsx)(i.A,{maxWidth:"xl",sx:{py:4},children:(0,r.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:(0,r.jsxs)(o.A,{variant:"h6",sx:{color:"#FF6B6B"},children:["❌ ",D]})})})})}):(0,r.jsx)(k.b,{children:(0,r.jsx)(F.A,{children:(0,r.jsxs)(i.A,{maxWidth:"xl",sx:{py:4},children:[(0,r.jsxs)(n.A,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,r.jsxs)(n.A,{children:[(0,r.jsx)(o.A,{variant:"h3",sx:{fontWeight:700,color:"#FFD600",mb:1},children:"\uD83D\uDCCA Security Analytics"}),(0,r.jsx)(o.A,{variant:"body1",sx:{color:"#B0B0B0"},children:"Last 7 Days Overview - Deep insights into network security threats and patterns"})]}),(0,r.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,r.jsx)(l.A,{label:"\uD83D\uDFE2 LIVE",sx:{backgroundColor:"#4CAF50",color:"#FFF",fontWeight:"bold",animation:"pulse 2s infinite"}}),(0,r.jsx)(c.A,{onClick:I,disabled:a,sx:{color:"#FFD600","&:hover":{backgroundColor:"rgba(255, 214, 0, 0.1)"},"&:disabled":{color:"#666"}},children:(0,r.jsx)(s.A,{})})]})]}),(0,r.jsxs)(n.A,{sx:{mb:4},children:[(0,r.jsx)(o.A,{variant:"h5",sx:{fontWeight:700,color:"#FFD600",mb:3},children:"Executive Summary"}),(0,r.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,r.jsx)(d.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsx)(L,{label:"Total Events",value:(null==t?void 0:t.total_alerts)||0,icon:"\uD83D\uDEA8",color:"#FFD600"})}),(0,r.jsx)(d.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsx)(L,{label:"Threat Actors",value:(null==t?void 0:t.unique_attackers)||0,icon:"\uD83D\uDC64",color:"#FF6B6B"})}),(0,r.jsx)(d.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsx)(L,{label:"Critical Alerts",value:(null==t?void 0:t.critical_alerts)||0,icon:"⚠️",color:"#F44336"})}),(0,r.jsx)(d.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsx)(L,{label:"High Severity",value:(null==t?void 0:t.high_alerts)||0,icon:"\uD83D\uDD34",color:"#FF8C42"})})]})]}),(0,r.jsxs)(d.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,r.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,r.jsxs)(h.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B"},children:[(0,r.jsx)(o.A,{variant:"h6",sx:{fontWeight:700,mb:2,color:"#FFD600"},children:"\uD83D\uDCC8 Alert Timeline"}),(0,r.jsx)(p.u,{width:"100%",height:300,children:(0,r.jsxs)(g.b,{data:(null==t?void 0:t.hourly_data)||[],children:[(0,r.jsx)(x.d,{strokeDasharray:"3 3",stroke:"#2B2B2B"}),(0,r.jsx)(y.W,{dataKey:"hour",stroke:"#B0B0B0"}),(0,r.jsx)(m.h,{stroke:"#B0B0B0"}),(0,r.jsx)(A.m,{contentStyle:{backgroundColor:"#2B2B2B",border:"none"}}),(0,r.jsx)(b.N,{type:"monotone",dataKey:"count",stroke:"#FFD600",strokeWidth:2})]})})]})}),(0,r.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,r.jsxs)(h.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B"},children:[(0,r.jsx)(o.A,{variant:"h6",sx:{fontWeight:700,mb:2,color:"#FFD600"},children:"\uD83C\uDFAF Severity Distribution"}),(0,r.jsx)(p.u,{width:"100%",height:300,children:(0,r.jsxs)(f.r,{children:[(0,r.jsx)(v.F,{data:(null==t?void 0:t.severity_breakdown)||[],cx:"50%",cy:"50%",labelLine:!1,label:t=>{let{severity:e,count:a}=t;return"".concat(e,": ").concat(a)},outerRadius:80,fill:"#8884d8",dataKey:"count",children:((null==t?void 0:t.severity_breakdown)||[]).map((t,e)=>(0,r.jsx)(j.f,{fill:U[e%U.length]},t.severity||"cell-".concat(e)))}),(0,r.jsx)(A.m,{})]})})]})})]}),(0,r.jsxs)(d.Ay,{container:!0,spacing:3,children:[(0,r.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,r.jsxs)(h.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B"},children:[(0,r.jsx)(o.A,{variant:"h6",sx:{fontWeight:700,mb:2,color:"#FFD600"},children:"Top Countries"}),(0,r.jsx)(p.u,{width:"100%",height:300,children:(0,r.jsxs)(B.E,{data:(null==t?void 0:t.top_countries)||[],children:[(0,r.jsx)(x.d,{strokeDasharray:"3 3",stroke:"#2B2B2B"}),(0,r.jsx)(y.W,{dataKey:"country",stroke:"#B0B0B0"}),(0,r.jsx)(m.h,{stroke:"#B0B0B0"}),(0,r.jsx)(A.m,{contentStyle:{backgroundColor:"#2B2B2B",border:"none"}}),(0,r.jsx)(w.y,{dataKey:"count",fill:"#FFD600"})]})})]})}),(0,r.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,r.jsxs)(h.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B"},children:[(0,r.jsx)(o.A,{variant:"h6",sx:{fontWeight:700,mb:2,color:"#FFD600"},children:"Protocols Used in Attacks"}),(0,r.jsx)(p.u,{width:"100%",height:300,children:(0,r.jsxs)(B.E,{data:(null==t?void 0:t.top_protocols)||[],children:[(0,r.jsx)(x.d,{strokeDasharray:"3 3",stroke:"#2B2B2B"}),(0,r.jsx)(y.W,{dataKey:"protocol",stroke:"#B0B0B0"}),(0,r.jsx)(m.h,{stroke:"#B0B0B0"}),(0,r.jsx)(A.m,{contentStyle:{backgroundColor:"#2B2B2B",border:"none"}}),(0,r.jsx)(w.y,{dataKey:"count",fill:"#FF8C42"})]})})]})})]})]})})})}},36300:(t,e,a)=>{"use strict";a.d(e,{b:()=>l});var r=a(95155),s=a(74512),i=a(93314),n=a(84563);let o=(0,s.A)({palette:{mode:"dark",primary:{main:"#FFD600",light:"#FFE54C",dark:"#F9A825",contrastText:"#000000"},secondary:{main:"#E0E0E0",contrastText:"#121212"},background:{default:"#121212",paper:"#1A1A1A"},text:{primary:"#E0E0E0",secondary:"#B0B0B0"},success:{main:"#4CAF50"},warning:{main:"#FF9800"},error:{main:"#F44336"},info:{main:"#2196F3"},divider:"#2B2B2B"},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"2.5rem",fontWeight:700,letterSpacing:"-0.02em"},h2:{fontSize:"2rem",fontWeight:700,letterSpacing:"-0.01em"},h4:{fontSize:"1.5rem",fontWeight:600},h6:{fontSize:"1rem",fontWeight:600},body1:{fontSize:"0.95rem",fontWeight:400},button:{fontWeight:600,textTransform:"none",letterSpacing:"0.5px"}},components:{MuiButton:{styleOverrides:{root:{borderRadius:"8px",transition:"all 0.2s ease-in-out"},contained:{"&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 16px rgba(255, 214, 0, 0.3)"}}}},MuiCard:{styleOverrides:{root:{backgroundColor:"#1A1A1A",borderRadius:"12px",border:"1px solid #2B2B2B"}}},MuiChip:{styleOverrides:{root:{fontWeight:600,fontSize:"0.85rem"}}}}});function l(t){let{children:e}=t;return(0,r.jsxs)(i.A,{theme:o,children:[(0,r.jsx)(n.Ay,{}),e]})}},75183:(t,e,a)=>{"use strict";a.d(e,{A:()=>i});var r=a(95125);class s{getApiUrl(){let t="http://localhost:8000";{let e=localStorage.getItem("dashboardConfig");if(e)try{let a=JSON.parse(e);a.apiUrl&&(t=a.apiUrl)}catch(t){console.warn("Failed to parse saved config for API URL:",t)}}return t.endsWith("/api")&&(t=t.replace("/api","")),"".concat(t,"/api")}async login(t){console.log("API login called with:",t);let e=await this.api.post("/auth/login",t);return console.log("API login response:",e.data),e.data}async validateToken(){return(await this.api.post("/auth/validate")).data}async logout(){return(await this.api.post("/auth/logout")).data}async getCurrentUser(){return(await this.api.get("/auth/me")).data}async getHealth(){return(await this.api.get("/health")).data}async getStatus(){return(await this.api.get("/status")).data}async getAlerts(){var t,e;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=new URLSearchParams({page:r.toString(),pageSize:s.toString()});return(null==(t=a.severity)?void 0:t.length)&&i.append("severity",a.severity.join(",")),(null==(e=a.detection_type)?void 0:e.length)&&i.append("detection_type",a.detection_type.join(",")),a.timeRange&&i.append("timeRange",a.timeRange),a.search&&i.append("search",a.search),(await this.api.get("/alerts?".concat(i.toString()))).data}async getAlertById(t){return(await this.api.get("/alerts/".concat(t))).data}async acknowledgeAlert(t){return(await this.api.patch("/alerts/".concat(t,"/acknowledge"))).data}async getDashboardStats(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"24hours";return(await this.api.get("/dashboard/stats?time_range=".concat(t))).data}async getAnalytics(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[t,e,a,r,s]=await Promise.all([this.api.get("/dashboard/stats"),this.api.get("/analytics/timeline?days=7"),this.api.get("/analytics/severity-distribution"),this.api.get("/analytics/attack-types"),this.api.get("/analytics/geographic")]);return{data:{total_alerts:t.data.totalAlerts||0,critical_alerts:t.data.criticalAlerts||0,high_alerts:0,medium_alerts:0,unique_attackers:t.data.uniqueAttackers||0,hourly_data:e.data||[],severity_breakdown:a.data||[],attack_types:r.data||[],top_countries:s.data||[],top_protocols:[]},success:!0}}async getAlertTimeline(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days",e=parseInt(t.replace(/[^0-9]/g,""),10)||7;return(await this.api.get("/analytics/timeline?days=".concat(e))).data}async getSeverityDistribution(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days";return(await this.api.get("/analytics/severity-distribution?time_range=".concat(t))).data}async getAttackDistribution(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days";return(await this.api.get("/analytics/attack-types?time_range=".concat(t))).data}async getTopIps(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await this.api.get("/analytics/protocol-stats?limit=".concat(t))).data}async generateSampleData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(await this.api.post("/database/generate-sample",{count:t})).data}async clearAlerts(){return(await this.api.delete("/alerts")).data}async testConnection(){return(await this.api.get("/database/test-connection")).data}async initializeDatabase(){return(await this.api.post("/database/initialize")).data}async seedDatabase(){return(await this.api.post("/db/seed")).data}async resetDatabase(){return(await this.api.post("/db/reset")).data}async getSystemStatus(){return(await this.api.get("/status")).data}async getRealtimeAlerts(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;return(await this.api.get("/local/realtime/alerts?limit=".concat(t,"&hours=").concat(e))).data}async getRealtimeStats(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;return(await this.api.get("/local/realtime/stats?hours=".concat(t))).data}async getLocalDatabaseInfo(){return(await this.api.get("/local/database/info")).data}async parseSuricataLog(t){let e=new FormData;return e.append("log_file",t),(await this.api.post("/local/suricata/parse-log",e,{headers:{"Content-Type":"multipart/form-data"}})).data}async generateSampleSuricataLog(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(await this.api.post("/local/suricata/generate-sample?count=".concat(t))).data}async getSyncStatus(){return(await this.api.get("/sync/status")).data}async startSyncService(){return(await this.api.post("/sync/start")).data}async stopSyncService(){return(await this.api.post("/sync/stop")).data}async forceSyncNow(){return(await this.api.post("/sync/force-sync")).data}refreshApiService(){this.baseURL=this.getApiUrl(),this.api=r.A.create({baseURL:this.baseURL,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{let e=localStorage.getItem("matseka_auth_token");return e&&(t.headers.Authorization="Bearer ".concat(e)),t})}async getIPManagementStats(){return this.api.get("/ip-management/stats")}async getAllIPs(){return this.api.get("/ip-management/ips")}async getLoginAttempts(t){return this.api.get(t?"/ip-management/login-attempts?ip=".concat(t):"/ip-management/login-attempts")}async getIPDetails(t){return this.api.get("/ip-management/ip/".concat(t,"/details"))}async blockIP(t){return this.api.post("/ip-management/block",t)}async whitelistIP(t){return this.api.post("/ip-management/whitelist",t)}async unblockIP(t){return this.api.post("/ip-management/unblock",t)}async checkIPStatus(t){return this.api.get("/ip-management/check/".concat(t))}async detectNetworkInfo(){return this.api.get("/network/detect")}async getSuricataConfig(){return this.api.get("/network/config")}async updateHomeNetworks(t){return this.api.put("/network/config/home-networks",t)}async updateNetworkInterface(t){return this.api.put("/network/config/interface",t)}async updatePortGroups(t){return this.api.put("/network/config/ports",t)}async validateSuricataConfig(){return this.api.post("/network/config/validate")}async restoreSuricataConfig(){return this.api.post("/network/config/restore")}async getProtocolStatistics(){return this.api.get("/analytics/protocol-details")}getBaseURL(){return this.baseURL}isConnected(){return!!this.baseURL}constructor(){this.baseURL=this.getApiUrl(),console.log("\uD83D\uDD17 API Service initialized"),console.log("\uD83D\uDCCD Base URL: ".concat(this.baseURL)),console.log("\uD83D\uDCA1 If this URL is wrong, clear localStorage: localStorage.removeItem('dashboardConfig')"),this.api=r.A.create({baseURL:this.baseURL,timeout:3e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{let e=localStorage.getItem("matseka_auth_token");return e&&(t.headers.Authorization="Bearer ".concat(e)),t}),this.api.interceptors.request.use(t=>{var e;return console.log("API Request: ".concat(null==(e=t.method)?void 0:e.toUpperCase()," ").concat(t.url)),t},t=>(console.error("API Request Error:",t),Promise.reject(t))),this.api.interceptors.response.use(t=>(console.log("API Response: ".concat(t.status," ").concat(t.config.url)),t),t=>{if("ERR_NETWORK"===t.code||"Network Error"===t.message)console.error("❌ NETWORK ERROR - Cannot reach backend API"),console.error("Attempted URL: ".concat(this.baseURL)),console.error("Possible causes:"),console.error("1. Backend server not running (expected: http://localhost:8000)"),console.error("2. Wrong API URL in localStorage (check 'dashboardConfig')"),console.error("3. CORS policy blocking the request"),console.error("4. Firewall or network issue"),console.error("\nTo fix: Run in browser console:"),console.error("  localStorage.getItem('dashboardConfig')"),console.error("  localStorage.removeItem('dashboardConfig') // if URL is wrong"),console.error("  location.reload()");else{var e;console.error("API Response Error:",t),(null==(e=t.response)?void 0:e.status)===404&&console.warn("API endpoint not found - backend may not be running")}return Promise.reject(t)})}}let i=new s},76530:(t,e,a)=>{"use strict";a.d(e,{A:()=>i});var r=a(36697),s=a(95155);let i=(0,r.A)((0,s.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh")},91029:(t,e,a)=>{Promise.resolve().then(a.bind(a,29735))}},t=>{t.O(0,[256,799,125,845,727,532,946,368,441,255,358],()=>t(t.s=91029)),_N_E=t.O()}]);