(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[484],{33110:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>eh});var s=t(95155),o=t(36697);let l=(0,o.A)((0,s.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),n=(0,o.A)((0,s.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");var i=t(76530),a=t(97322),c=t(80851),d=t(4474),x=t(23315),u=t(78010),h=t(61259),p=t(61023),A=t(56422),m=t(70690),g=t(52641),j=t(51221),b=t(48720),y=t(86973),f=t(28548),v=t(33077),B=t(21067),C=t(2778),k=t(52363),F=t(65036),w=t(75912),S=t(12115),_=t(36300),D=t(14041),I=t(77073),P=t(97516),W=t(36741),L=t(61205),z=t(42047);let M=(0,o.A)([(0,s.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,s.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"AccessTime");var O=t(37045),E=t(41983),R=t(29767),T=t(67810),N=t(88945),H=t(2821),U=t(57001),q=t(16625),K=t(48116),G=t(85795),V=t(95195);function Y(e){return(0,V.Ay)("MuiCardHeader",e)}let J=(0,G.A)("MuiCardHeader",["root","avatar","action","content","title","subheader"]),Q=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],X=(0,K.Ay)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,r)=>(0,N.A)({["& .".concat(J.title)]:r.title,["& .".concat(J.subheader)]:r.subheader},r.root)})({display:"flex",alignItems:"center",padding:16}),Z=(0,K.Ay)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,r)=>r.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),$=(0,K.Ay)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,r)=>r.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),ee=(0,K.Ay)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,r)=>r.content})({flex:"1 1 auto"}),er=S.forwardRef(function(e,r){let t=(0,q.b)({props:e,name:"MuiCardHeader"}),{action:o,avatar:l,className:n,component:i="div",disableTypography:a=!1,subheader:c,subheaderTypographyProps:d,title:u,titleTypographyProps:h}=t,p=(0,T.A)(t,Q),A=(0,N.A)({},t,{component:i,disableTypography:a}),m=(e=>{let{classes:r}=e;return(0,U.A)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},Y,r)})(A),g=u;null==g||g.type===x.A||a||(g=(0,s.jsx)(x.A,(0,N.A)({variant:l?"body2":"h5",className:m.title,component:"span",display:"block"},h,{children:g})));let j=c;return null==j||j.type===x.A||a||(j=(0,s.jsx)(x.A,(0,N.A)({variant:l?"body2":"body1",className:m.subheader,color:"text.secondary",component:"span",display:"block"},d,{children:j}))),(0,s.jsxs)(X,(0,N.A)({className:(0,H.A)(m.root,n),as:i,ref:r,ownerState:A},p,{children:[l&&(0,s.jsx)(Z,{className:m.avatar,ownerState:A,children:l}),(0,s.jsxs)(ee,{className:m.content,ownerState:A,children:[g,j]}),o&&(0,s.jsx)($,{className:m.action,ownerState:A,children:o})]}))});var et=t(84578),es=t(41602),eo=t(23820),el=t(49501),en=t(73741),ei=t(17681),ea=t(62890);let ec=["Suspicious activity detected","Multiple failed login attempts","Known malicious IP","Brute force attack","DDoS attempt","Malware communication","Command and control server","Phishing attempt","Port scanning","Other security threat"],ed=["Trusted internal network","Authorized service provider","Legitimate business partner","Security testing environment","Monitoring system","Backup service","CDN provider","Load balancer","Other legitimate use"],ex=e=>{let{open:r,onClose:t,ip:o,onActionComplete:l}=e,[n,i]=(0,S.useState)(null),[a,h]=(0,S.useState)(!1),[A,B]=(0,S.useState)(!1),[_,T]=(0,S.useState)(null),[N,H]=(0,S.useState)(null),[U,q]=(0,S.useState)(!1),[K,G]=(0,S.useState)(!1),[V,Y]=(0,S.useState)(""),[J,Q]=(0,S.useState)(24),[X,Z]=(0,S.useState)("temporary"),[$,ee]=(0,S.useState)(""),ex=(0,S.useCallback)(async()=>{h(!0),T(null);try{let e=(0,ea.getSupabaseClient)();if(!e){T("Database not configured"),h(!1);return}let{data:r,error:t}=await e.from("ip_management").select("*").eq("ip_address",o).single();if(t&&"PGRST116"!==t.code)throw t;let{data:s,error:l}=await e.from("security_alerts").select("*").or("src_ip.eq.".concat(o,",dest_ip.eq.").concat(o)).order("timestamp",{ascending:!1}).limit(10);l&&console.error("Error fetching alerts:",l);let n={ip:o,isBlocked:(null==r?void 0:r.is_blocked)||!1,isWhitelisted:(null==r?void 0:r.is_whitelisted)||!1,riskScore:(null==r?void 0:r.risk_score)||0,country:(null==r?void 0:r.country)||"Unknown",city:(null==r?void 0:r.city)||"Unknown",isp:(null==r?void 0:r.isp)||"Unknown",organization:(null==r?void 0:r.asn)||"Unknown",timezone:(null==r?void 0:r.region)||"Unknown",lastSeen:(null==r?void 0:r.last_seen)||new Date().toISOString(),blockReason:null==r?void 0:r.block_reason,blockedAt:null==r?void 0:r.blocked_until,alertCount:(null==s?void 0:s.length)||0,loginAttempts:[],recentAlerts:(null==s?void 0:s.map(e=>({id:e.id,timestamp:e.timestamp,severity:e.severity||"unknown",attackType:e.attack_type||"unknown",message:e.message||""})))||[]};i(n)}catch(e){console.error("Error fetching IP details:",e),T(e.message||"Failed to fetch IP details")}finally{h(!1)}},[o]);(0,S.useEffect)(()=>{r&&o&&ex()},[r,o,ex]);let eu=async()=>{B(!0),T(null);try{let e=(0,ea.getSupabaseClient)();if(!e){T("Database not configured"),B(!1);return}let r="temporary"===X?new Date(Date.now()+60*J*6e4).toISOString():null,{error:t}=await e.from("ip_management").upsert({ip_address:o,status:"blocked",is_blocked:!0,is_whitelisted:!1,block_reason:V,blocked_until:r,last_seen:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"ip_address"});if(t)throw t;H("IP ".concat(o," has been blocked successfully")),q(!1),ex(),null==l||l()}catch(e){T(e.message||"Failed to block IP")}finally{B(!1)}},eh=async()=>{B(!0),T(null);try{let e=(0,ea.getSupabaseClient)();if(!e){T("Database not configured"),B(!1);return}let{error:r}=await e.from("ip_management").upsert({ip_address:o,status:"whitelisted",is_blocked:!1,is_whitelisted:!0,whitelist_reason:$,blocked_until:null,last_seen:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"ip_address"});if(r)throw r;H("IP ".concat(o," has been whitelisted successfully")),G(!1),ex(),null==l||l()}catch(e){T(e.message||"Failed to whitelist IP")}finally{B(!1)}},ep=async()=>{B(!0),T(null);try{let e=(0,ea.getSupabaseClient)();if(!e){T("Database not configured"),B(!1);return}let{error:r}=await e.from("ip_management").update({status:"allowed",is_blocked:!1,blocked_until:null,block_reason:null,last_seen:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("ip_address",o);if(r)throw r;H("IP ".concat(o," has been unblocked successfully")),ex(),null==l||l()}catch(e){T(e.message||"Failed to unblock IP")}finally{B(!1)}},eA=e=>new Date(e).toLocaleString(),em=()=>{q(!1),G(!1),Y(""),Q(24),Z("temporary"),ee(""),T(null),H(null),t()};return r?(0,s.jsxs)(C.A,{open:r,onClose:em,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{backgroundColor:"#1A1A1A",color:"#FFF",minHeight:"80vh"}},children:[(0,s.jsxs)(k.A,{sx:{backgroundColor:"#2B2B2B",color:"#FFD600",display:"flex",alignItems:"center",justifyContent:"space-between",pr:1},children:[(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(D.A,{}),(0,s.jsxs)(x.A,{variant:"h6",component:"div",children:["IP Management: ",o]})]}),(0,s.jsx)(E.A,{onClick:em,sx:{color:"#FFD600"},children:(0,s.jsx)(I.A,{})})]}),(0,s.jsx)(F.A,{sx:{p:3},children:a?(0,s.jsx)(c.A,{sx:{display:"flex",justifyContent:"center",py:4},children:(0,s.jsx)(d.A,{sx:{color:"#FFD600"}})}):_?(0,s.jsx)(u.A,{severity:"error",sx:{mb:2},children:_}):N?(0,s.jsx)(u.A,{severity:"success",sx:{mb:2},children:N}):n?(0,s.jsxs)(c.A,{children:[(0,s.jsx)(R.A,{sx:{mb:3,backgroundColor:"#2B2B2B"},children:(0,s.jsx)(er,{title:(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,s.jsx)(x.A,{variant:"h6",sx:{color:"#FFD600"},children:n.ip}),(0,s.jsx)(f.A,{label:n.isBlocked?"BLOCKED":n.isWhitelisted?"WHITELISTED":"ALLOWED",color:n.isBlocked?"error":n.isWhitelisted?"success":"default",sx:{fontWeight:"bold"}}),(0,s.jsx)(f.A,{label:"Risk: ".concat(n.riskScore,"/100"),sx:{backgroundColor:(e=>e>=80?"#f44336":e>=60?"#ff9800":e>=40?"#ffeb3b":"#4caf50")(n.riskScore),color:"#FFF",fontWeight:"bold"}})]}),action:(0,s.jsxs)(c.A,{sx:{display:"flex",gap:1},children:[!n.isBlocked&&!n.isWhitelisted&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.A,{variant:"contained",color:"error",startIcon:(0,s.jsx)(P.A,{}),onClick:()=>q(!0),size:"small",children:"Block"}),(0,s.jsx)(m.A,{variant:"contained",color:"success",startIcon:(0,s.jsx)(W.A,{}),onClick:()=>G(!0),size:"small",children:"Whitelist"})]}),n.isBlocked&&(0,s.jsx)(m.A,{variant:"contained",color:"primary",onClick:ep,disabled:A,size:"small",children:A?(0,s.jsx)(d.A,{size:20}):"Unblock"})]})})}),(0,s.jsxs)(v.Ay,{container:!0,spacing:3,sx:{mb:3},children:[(0,s.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,s.jsxs)(R.A,{sx:{backgroundColor:"#2B2B2B"},children:[(0,s.jsx)(er,{title:"Location Information"}),(0,s.jsx)(et.A,{children:(0,s.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(L.A,{sx:{color:"#FFD600"}}),(0,s.jsxs)(x.A,{variant:"body2",children:[(0,s.jsx)("strong",{children:"Country:"})," ",n.country||"Unknown"]})]}),(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(L.A,{sx:{color:"#FFD600"}}),(0,s.jsxs)(x.A,{variant:"body2",children:[(0,s.jsx)("strong",{children:"City:"})," ",n.city||"Unknown"]})]}),(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(z.A,{sx:{color:"#FFD600"}}),(0,s.jsxs)(x.A,{variant:"body2",children:[(0,s.jsx)("strong",{children:"ISP:"})," ",n.isp||"Unknown"]})]}),(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(z.A,{sx:{color:"#FFD600"}}),(0,s.jsxs)(x.A,{variant:"body2",children:[(0,s.jsx)("strong",{children:"Organization:"})," ",n.organization||"Unknown"]})]})]})})]})}),(0,s.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,s.jsxs)(R.A,{sx:{backgroundColor:"#2B2B2B"},children:[(0,s.jsx)(er,{title:"Security Information"}),(0,s.jsx)(et.A,{children:(0,s.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(M,{sx:{color:"#FFD600"}}),(0,s.jsxs)(x.A,{variant:"body2",children:[(0,s.jsx)("strong",{children:"Last Seen:"})," ",eA(n.lastSeen)]})]}),(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(O.A,{sx:{color:"#FFD600"}}),(0,s.jsxs)(x.A,{variant:"body2",children:[(0,s.jsx)("strong",{children:"Alert Count:"})," ",n.alertCount]})]}),n.isBlocked&&n.blockReason&&(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(P.A,{sx:{color:"#f44336"}}),(0,s.jsxs)(x.A,{variant:"body2",children:[(0,s.jsx)("strong",{children:"Block Reason:"})," ",n.blockReason]})]}),n.blockedAt&&(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(M,{sx:{color:"#FFD600"}}),(0,s.jsxs)(x.A,{variant:"body2",children:[(0,s.jsx)("strong",{children:"Blocked At:"})," ",eA(n.blockedAt)]})]})]})})]})})]}),(0,s.jsxs)(R.A,{sx:{backgroundColor:"#2B2B2B",mb:3},children:[(0,s.jsx)(er,{title:"Login Attempts"}),(0,s.jsx)(et.A,{children:n.loginAttempts.length>0?(0,s.jsx)(es.A,{children:n.loginAttempts.map((e,r)=>(0,s.jsxs)(eo.Ay,{sx:{borderBottom:"1px solid #333"},children:[(0,s.jsx)(el.A,{children:(0,s.jsx)(en.A,{sx:{backgroundColor:e.success?"#4caf50":"#f44336",width:32,height:32},children:e.success?"✓":"✗"})}),(0,s.jsx)(ei.A,{primary:(0,s.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(x.A,{variant:"body1",children:e.username}),(0,s.jsx)(f.A,{label:e.success?"Success":"Failed",size:"small",color:e.success?"success":"error"}),e.is_blocked&&(0,s.jsx)(f.A,{label:"permanent"===e.block_type?"Permanent Block":"Temporary Block",size:"small",color:"warning"})]}),secondary:(0,s.jsxs)(c.A,{children:[(0,s.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:[eA(e.timestamp)," • Attempt #",e.attempt_count]}),e.user_agent&&(0,s.jsx)(x.A,{variant:"caption",color:"text.secondary",children:e.user_agent})]})})]},e.id))}):(0,s.jsx)(x.A,{variant:"body2",color:"text.secondary",children:"No login attempts recorded for this IP."})})]}),U&&(0,s.jsxs)(R.A,{sx:{backgroundColor:"#2B2B2B",mb:3},children:[(0,s.jsx)(er,{title:"Block IP Address"}),(0,s.jsx)(et.A,{children:(0,s.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,s.jsxs)(g.A,{fullWidth:!0,children:[(0,s.jsx)(j.A,{sx:{color:"#B0B0B0"},children:"Block Type"}),(0,s.jsxs)(b.A,{value:X,onChange:e=>Z(e.target.value),sx:{color:"#FFF"},children:[(0,s.jsx)(y.A,{value:"temporary",children:"Temporary"}),(0,s.jsx)(y.A,{value:"permanent",children:"Permanent"})]})]}),"temporary"===X&&(0,s.jsx)(p.A,{label:"Duration (hours)",type:"number",value:J,onChange:e=>Q(parseInt(e.target.value,10)||24),sx:{color:"#FFF"}}),(0,s.jsxs)(g.A,{fullWidth:!0,children:[(0,s.jsx)(j.A,{sx:{color:"#B0B0B0"},children:"Reason"}),(0,s.jsx)(b.A,{value:V,onChange:e=>Y(e.target.value),sx:{color:"#FFF"},children:ec.map(e=>(0,s.jsx)(y.A,{value:e,children:e},e))})]}),(0,s.jsxs)(c.A,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[(0,s.jsx)(m.A,{onClick:()=>q(!1),children:"Cancel"}),(0,s.jsx)(m.A,{variant:"contained",color:"error",onClick:eu,disabled:A||!V,children:A?(0,s.jsx)(d.A,{size:20}):"Block IP"})]})]})})]}),K&&(0,s.jsxs)(R.A,{sx:{backgroundColor:"#2B2B2B",mb:3},children:[(0,s.jsx)(er,{title:"Whitelist IP Address"}),(0,s.jsx)(et.A,{children:(0,s.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,s.jsxs)(g.A,{fullWidth:!0,children:[(0,s.jsx)(j.A,{sx:{color:"#B0B0B0"},children:"Reason"}),(0,s.jsx)(b.A,{value:$,onChange:e=>ee(e.target.value),sx:{color:"#FFF"},children:ed.map(e=>(0,s.jsx)(y.A,{value:e,children:e},e))})]}),(0,s.jsxs)(c.A,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[(0,s.jsx)(m.A,{onClick:()=>G(!1),children:"Cancel"}),(0,s.jsx)(m.A,{variant:"contained",color:"success",onClick:eh,disabled:A||!$,children:A?(0,s.jsx)(d.A,{size:20}):"Whitelist IP"})]})]})})]})]}):null}),(0,s.jsx)(w.A,{sx:{backgroundColor:"#2B2B2B",p:2},children:(0,s.jsx)(m.A,{onClick:em,sx:{color:"#FFD600"},children:"Close"})})]}):null};var eu=t(46368);function eh(){let[e,r]=(0,S.useState)(!0),[t,o]=(0,S.useState)([]),[D,I]=(0,S.useState)([]),[P,W]=(0,S.useState)(""),[L,z]=(0,S.useState)(""),[M,O]=(0,S.useState)(["critical","high","medium","low"]),[E,R]=(0,S.useState)(!1),[T,N]=(0,S.useState)([]),[H,U]=(0,S.useState)("24hours"),[q,K]=(0,S.useState)(null),[G,V]=(0,S.useState)(!1),[Y,J]=(0,S.useState)(""),[Q,X]=(0,S.useState)(null),[Z,$]=(0,S.useState)({open:!1,ip:""}),ee=(0,S.useCallback)(async()=>{r(!0),X(null);try{let e=(0,ea.getSupabaseClient)();if(!e){X("Database not configured. Please check your connection settings."),r(!1);return}let t=e.from("security_alerts").select("*").order("timestamp",{ascending:!1});if("30days"!==H){let e=new Date,r=24;switch(H){case"1hour":r=1;break;case"6hours":r=6;break;case"24hours":r=24;break;case"7days":r=168}let s=new Date(e.getTime()-60*r*6e4).toISOString();t=t.gte("timestamp",s)}M.length>0&&M.length<4&&(t=t.in("severity",M)),T.length>0&&(t=t.in("detection_type",T));let{data:s,error:l}=await t.limit(500);if(l)throw console.error("Supabase error details:",l),Error(l.message);let n=s||[];if(console.log("Loaded ".concat(n.length," alerts from database")),L.trim()){let e=L.toLowerCase();n=n.filter(r=>{var t,s,o,l,n;return(null==(t=r.message)?void 0:t.toLowerCase().includes(e))||(null==(s=r.src_ip)?void 0:s.toLowerCase().includes(e))||(null==(o=r.dest_ip)?void 0:o.toLowerCase().includes(e))||(null==(l=r.detection_type)?void 0:l.toLowerCase().includes(e))||(null==(n=r.attack_type)?void 0:n.toLowerCase().includes(e))}),console.log("Filtered to ".concat(n.length,' alerts matching "').concat(L,'"'))}let i=n.map(e=>({...e,source_ip:e.src_ip||e.source_ip,destination_ip:e.dest_ip||e.destination_ip,source_port:e.src_port||e.source_port,destination_port:e.dest_port||e.destination_port}));o(i),i.length>0&&K(i[0])}catch(e){console.error("Error loading alerts:",e),X("Failed to load alerts. Please check your connection and try again.")}finally{r(!1)}},[H,M,T,L]),er=(0,S.useCallback)(()=>{let e=t;I(e=E?e.filter(e=>!0===e.is_acknowledged):e.filter(e=>!0!==e.is_acknowledged))},[t,E]);(0,S.useEffect)(()=>{let e=setTimeout(()=>{z(P)},500);return()=>clearTimeout(e)},[P]),(0,S.useEffect)(()=>{ee()},[ee]),(0,S.useEffect)(()=>{er()},[er]);let et=e=>{$({open:!0,ip:e})},es=e=>{switch(e.toLowerCase()){case"critical":return"error";case"high":return"warning";case"medium":return"info";case"low":return"success";default:return"default"}},eo=async e=>{try{let r=(0,ea.getSupabaseClient)();if(!r)return void X("Database not configured");let{error:t}=await r.from("security_alerts").update({is_acknowledged:!0}).eq("id",e);if(t)throw t;await ee()}catch(e){console.error("Error acknowledging alert:",e),X("Failed to acknowledge alert")}};return e?(0,s.jsx)(_.b,{children:(0,s.jsx)(eu.A,{children:(0,s.jsx)(a.A,{maxWidth:"xl",sx:{py:4},children:(0,s.jsx)(c.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,s.jsx)(d.A,{sx:{color:"#FFD600"}})})})})}):(0,s.jsx)(_.b,{children:(0,s.jsx)(eu.A,{children:(0,s.jsxs)(a.A,{maxWidth:"xl",sx:{py:4},children:[(0,s.jsxs)(c.A,{sx:{mb:4},children:[(0,s.jsx)(x.A,{variant:"h3",sx:{fontWeight:700,color:"#FFD600",mb:1},children:"\uD83D\uDEA8 Security Alerts"}),(0,s.jsxs)(x.A,{variant:"body1",sx:{color:"#B0B0B0"},children:[D.length," of ",t.length," alerts"]})]}),Q&&(0,s.jsx)(u.A,{severity:"error",sx:{mb:3},children:Q}),(0,s.jsxs)(h.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",p:3,mb:3},children:[(0,s.jsx)(p.A,{fullWidth:!0,placeholder:"Search alerts...",value:P,onChange:e=>W(e.target.value),InputProps:{startAdornment:(0,s.jsx)(A.A,{position:"start",children:(0,s.jsx)(l,{sx:{color:"#B0B0B0"}})}),endAdornment:P&&(0,s.jsx)(A.A,{position:"end",children:(0,s.jsx)(m.A,{onClick:()=>W(""),size:"small",sx:{minWidth:"auto",p:.5},children:(0,s.jsx)(n,{sx:{color:"#B0B0B0"}})})})},sx:{mb:3,"& .MuiOutlinedInput-root":{color:"#FFF","& fieldset":{borderColor:"#2B2B2B"},"&:hover fieldset":{borderColor:"#FFD600"},"&.Mui-focused fieldset":{borderColor:"#FFD600"}}}}),(0,s.jsxs)(g.A,{sx:{mb:3,minWidth:200},children:[(0,s.jsx)(j.A,{sx:{color:"#B0B0B0"},children:"Time Range"}),(0,s.jsxs)(b.A,{value:H,onChange:e=>U(e.target.value),label:"Time Range",sx:{color:"#FFF","& .MuiOutlinedInput-notchedOutline":{borderColor:"#2B2B2B"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#FFD600"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#FFD600"}},children:[(0,s.jsx)(y.A,{value:"1hour",children:"Last Hour"}),(0,s.jsx)(y.A,{value:"6hours",children:"Last 6 Hours"}),(0,s.jsx)(y.A,{value:"24hours",children:"Last 24 Hours"}),(0,s.jsx)(y.A,{value:"7days",children:"Last 7 Days"}),(0,s.jsx)(y.A,{value:"30days",children:"Last 30 Days"})]})]}),(0,s.jsxs)(c.A,{sx:{mb:3},children:[(0,s.jsx)(x.A,{variant:"body2",sx:{color:"#B0B0B0",mb:1},children:"Filter by Severity"}),(0,s.jsxs)(c.A,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[["critical","high","medium","low"].map(e=>(0,s.jsx)(f.A,{label:e.toUpperCase(),onClick:()=>{M.includes(e)?O(M.filter(r=>r!==e)):O([...M,e])},color:M.includes(e)?"primary":"default",variant:M.includes(e)?"filled":"outlined",sx:{backgroundColor:M.includes(e)?"#FFD600":"transparent",color:M.includes(e)?"#000":"#B0B0B0",borderColor:"#2B2B2B",cursor:"pointer","&:hover":{backgroundColor:M.includes(e)?"#FFD600":"#2B2B2B"}}},e)),(0,s.jsx)(f.A,{label:"ACKNOWLEDGED",onClick:()=>R(!E),color:E?"primary":"default",variant:E?"filled":"outlined",sx:{backgroundColor:E?"#4CAF50":"transparent",color:E?"#000":"#B0B0B0",borderColor:"#2B2B2B",cursor:"pointer","&:hover":{backgroundColor:E?"#4CAF50":"#2B2B2B"}}})]})]}),(0,s.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[(0,s.jsx)(m.A,{variant:"outlined",startIcon:(0,s.jsx)(i.A,{}),onClick:ee,sx:{borderColor:"#FFD600",color:"#FFD600","&:hover":{borderColor:"#FFD600",backgroundColor:"#FFD60020"}},children:"Refresh"}),(0,s.jsx)(m.A,{variant:"outlined",startIcon:(0,s.jsx)(n,{}),onClick:()=>{W(""),O(["critical","high","medium","low"]),N([]),R(!1)},sx:{borderColor:"#B0B0B0",color:"#B0B0B0","&:hover":{borderColor:"#B0B0B0",backgroundColor:"#B0B0B020"}},children:"Clear Filters"})]})]}),(0,s.jsxs)(v.Ay,{container:!0,spacing:3,children:[(0,s.jsx)(v.Ay,{item:!0,xs:12,md:4,children:(0,s.jsxs)(h.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",maxHeight:"600px",overflow:"auto"},children:[(0,s.jsx)(c.A,{sx:{p:2},children:(0,s.jsxs)(x.A,{variant:"h6",sx:{fontWeight:700,color:"#FFD600",mb:2},children:["Recent Alerts (",t.length,")"]})}),(0,s.jsx)(B.A,{sx:{borderColor:"#2B2B2B"}}),t.map(e=>(0,s.jsxs)(c.A,{onClick:()=>K(e),sx:{p:2,cursor:"pointer",backgroundColor:(null==q?void 0:q.id)===e.id?"#2B2B2B":"transparent",borderLeft:(null==q?void 0:q.id)===e.id?"4px solid #FFD600":"none","&:hover":{backgroundColor:"#2B2B2B"}},children:[(0,s.jsxs)(c.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"start",mb:1},children:[(0,s.jsx)(f.A,{label:e.severity,color:es(e.severity),size:"small",variant:"outlined"}),(0,s.jsx)(x.A,{variant:"caption",sx:{color:"#B0B0B0"},children:new Date(e.created_at).toLocaleTimeString()})]}),(0,s.jsx)(x.A,{variant:"body2",sx:{color:"#FFD600",fontFamily:"monospace",fontSize:"0.75rem",cursor:"pointer",textDecoration:"underline","&:hover":{color:"#FFF"}},onClick:r=>{r.stopPropagation(),et(e.source_ip)},children:e.source_ip}),(0,s.jsx)(x.A,{variant:"caption",sx:{color:"#B0B0B0"},children:e.detection_type})]},e.id))]})}),(0,s.jsx)(v.Ay,{item:!0,xs:12,md:8,children:q?(0,s.jsxs)(c.A,{children:[(0,s.jsxs)(h.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",p:3,mb:3},children:[(0,s.jsxs)(c.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,s.jsxs)(c.A,{children:[(0,s.jsx)(x.A,{variant:"h5",sx:{color:"#FFD600",fontWeight:700,mb:1},children:q.detection_type}),(0,s.jsxs)(x.A,{variant:"body2",sx:{color:"#B0B0B0"},children:["Alert ID: ",q.id]})]}),(0,s.jsxs)(c.A,{sx:{display:"flex",gap:1},children:[(0,s.jsx)(f.A,{label:q.severity,color:es(q.severity),variant:"outlined"}),(0,s.jsx)(f.A,{label:q.is_acknowledged?"✓ Acknowledged":"New",sx:{backgroundColor:q.is_acknowledged?"#4CAF50":"#FFD600",color:"#000"}})]})]}),(0,s.jsx)(B.A,{sx:{borderColor:"#2B2B2B",my:2}}),(0,s.jsx)(x.A,{variant:"h6",sx:{color:"#FFD600",fontWeight:700,mb:2},children:"Network Information"}),(0,s.jsx)(v.Ay,{container:!0,spacing:2,sx:{mb:3},children:[{label:"Source IP",value:q.source_ip,isIP:!0},{label:"Source Port",value:q.source_port,isIP:!1},{label:"Destination IP",value:q.destination_ip,isIP:!0},{label:"Destination Port",value:q.destination_port,isIP:!1},{label:"Protocol",value:q.protocol,isIP:!1},{label:"Protocol Info",value:q.protocol_info,isIP:!1}].map(e=>(0,s.jsxs)(v.Ay,{item:!0,xs:12,sm:6,children:[(0,s.jsx)(x.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:e.label}),(0,s.jsx)(x.A,{variant:"body2",sx:{color:e.isIP?"#FFD600":"#FFF",fontFamily:"monospace",cursor:e.isIP?"pointer":"default",textDecoration:e.isIP?"underline":"none","&:hover":e.isIP?{color:"#FFF"}:{}},onClick:e.isIP&&e.value?()=>et(String(e.value)):void 0,children:e.value})]},e.label))}),(0,s.jsx)(B.A,{sx:{borderColor:"#2B2B2B",my:2}}),(0,s.jsx)(x.A,{variant:"h6",sx:{color:"#FFD600",fontWeight:700,mb:2},children:"Threat Assessment"}),(0,s.jsx)(v.Ay,{container:!0,spacing:2,sx:{mb:3},children:[{label:"Risk Score",value:"".concat(q.event_count?10*q.event_count:50,"/100")},{label:"Event Count",value:q.event_count||1},{label:"Country",value:"Unknown"},{label:"City",value:"Unknown"}].map(e=>(0,s.jsxs)(v.Ay,{item:!0,xs:12,sm:6,children:[(0,s.jsx)(x.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:e.label}),(0,s.jsx)(x.A,{variant:"body2",sx:{color:"#FFF"},children:e.value})]},e.label))}),(0,s.jsx)(B.A,{sx:{borderColor:"#2B2B2B",my:2}}),(0,s.jsx)(x.A,{variant:"h6",sx:{color:"#FFD600",fontWeight:700,mb:2},children:"Payload Snippet"}),(0,s.jsx)(h.A,{sx:{backgroundColor:"#0D0D0D",p:2,mb:3,border:"1px solid #2B2B2B",overflow:"auto",maxHeight:"200px"},children:(0,s.jsx)(x.A,{variant:"body2",sx:{color:"#FFD600",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-all",fontSize:"0.75rem"},children:q.payload_snippet||"No payload available"})}),(0,s.jsxs)(x.A,{variant:"body2",sx:{color:"#B0B0B0"},children:["Created:"," ",new Date(q.created_at).toLocaleString()]}),(0,s.jsxs)(x.A,{variant:"body2",sx:{color:"#B0B0B0"},children:["Updated:"," ",new Date(q.updated_at).toLocaleString()]})]}),(0,s.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[(0,s.jsx)(m.A,{variant:"contained",sx:{backgroundColor:q.is_acknowledged?"#4CAF50":"#FFD600",color:"#000",fontWeight:700,"&:hover":{backgroundColor:q.is_acknowledged?"#45A049":"#F9A825"}},onClick:()=>eo(q.id.toString()),disabled:q.is_acknowledged,children:q.is_acknowledged?"Acknowledged":"Acknowledge Alert"}),(0,s.jsx)(m.A,{variant:"contained",sx:{backgroundColor:"#FFD600",color:"#000",fontWeight:700},onClick:()=>V(!0),children:"Add Notes"}),(0,s.jsx)(m.A,{variant:"outlined",sx:{borderColor:"#FFD600",color:"#FFD600"},children:"Export Report"})]})]}):(0,s.jsx)(h.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",p:3},children:(0,s.jsx)(x.A,{sx:{color:"#B0B0B0",textAlign:"center"},children:"Select an alert to view details"})})})]}),(0,s.jsxs)(C.A,{open:G,onClose:()=>V(!1),maxWidth:"sm",fullWidth:!0,children:[(0,s.jsx)(k.A,{sx:{backgroundColor:"#1A1A1A",color:"#FFD600"},children:"Add Notes to Alert"}),(0,s.jsx)(F.A,{sx:{backgroundColor:"#1A1A1A",mt:2},children:(0,s.jsx)(p.A,{fullWidth:!0,multiline:!0,rows:4,placeholder:"Add your analysis notes...",value:Y,onChange:e=>J(e.target.value),sx:{"& .MuiOutlinedInput-root":{color:"#FFF","& fieldset":{borderColor:"#2B2B2B"}}}})}),(0,s.jsxs)(w.A,{sx:{backgroundColor:"#1A1A1A",p:2},children:[(0,s.jsx)(m.A,{onClick:()=>V(!1),sx:{color:"#B0B0B0"},children:"Cancel"}),(0,s.jsx)(m.A,{onClick:()=>{V(!1),J("")},sx:{backgroundColor:"#FFD600",color:"#000",fontWeight:700},children:"Save Notes"})]})]}),(0,s.jsx)(ex,{open:Z.open,onClose:()=>{$({open:!1,ip:""})},ip:Z.ip,onActionComplete:()=>{ee()}})]})})})}},36300:(e,r,t)=>{"use strict";t.d(r,{b:()=>a});var s=t(95155),o=t(74512),l=t(93314),n=t(84563);let i=(0,o.A)({palette:{mode:"dark",primary:{main:"#FFD600",light:"#FFE54C",dark:"#F9A825",contrastText:"#000000"},secondary:{main:"#E0E0E0",contrastText:"#121212"},background:{default:"#121212",paper:"#1A1A1A"},text:{primary:"#E0E0E0",secondary:"#B0B0B0"},success:{main:"#4CAF50"},warning:{main:"#FF9800"},error:{main:"#F44336"},info:{main:"#2196F3"},divider:"#2B2B2B"},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"2.5rem",fontWeight:700,letterSpacing:"-0.02em"},h2:{fontSize:"2rem",fontWeight:700,letterSpacing:"-0.01em"},h4:{fontSize:"1.5rem",fontWeight:600},h6:{fontSize:"1rem",fontWeight:600},body1:{fontSize:"0.95rem",fontWeight:400},button:{fontWeight:600,textTransform:"none",letterSpacing:"0.5px"}},components:{MuiButton:{styleOverrides:{root:{borderRadius:"8px",transition:"all 0.2s ease-in-out"},contained:{"&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 16px rgba(255, 214, 0, 0.3)"}}}},MuiCard:{styleOverrides:{root:{backgroundColor:"#1A1A1A",borderRadius:"12px",border:"1px solid #2B2B2B"}}},MuiChip:{styleOverrides:{root:{fontWeight:600,fontSize:"0.85rem"}}}}});function a(e){let{children:r}=e;return(0,s.jsxs)(l.A,{theme:i,children:[(0,s.jsx)(n.Ay,{}),r]})}},37045:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(36697),o=t(95155);let l=(0,s.A)((0,o.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning")},42047:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(36697),o=t(95155);let l=(0,s.A)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info")},61205:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(36697),o=t(95155);let l=(0,s.A)((0,o.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"LocationOn")},65562:(e,r,t)=>{Promise.resolve().then(t.bind(t,33110))},76530:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(36697),o=t(95155);let l=(0,s.A)((0,o.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh")},97516:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(36697),o=t(95155);let l=(0,s.A)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"}),"Block")}},e=>{e.O(0,[256,799,845,946,368,441,255,358],()=>e(e.s=65562)),_N_E=e.O()}]);