(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[319],{58047:(e,t,o)=>{Promise.resolve().then(o.bind(o,77993))},77993:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>q});var r=o(95155),s=o(76530),i=o(14041),n=o(12216),l=o(17702),a=o(80851),c=o(97322),d=o(23315),x=o(28548),h=o(41983),u=o(33077),p=o(61259),A=o(55369),m=o(26466),j=o(12115),g=o(26991),b=o(73850),B=o(68425),k=o(47734),y=o(73697),f=o(33420),v=o(94621),F=o(80019),w=o(57095);function _(e){let{data:t,title:o,color:s,type:i="line",height:n=200}=e,[l,c]=(0,j.useState)(!0);(0,j.useEffect)(()=>{let e=setInterval(()=>{c(e=>!e)},1e3);return()=>clearInterval(e)},[]);let h=e=>new Date(e).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),u=e=>{let{active:t,payload:o,label:i}=e;return t&&o&&o.length?(0,r.jsxs)(p.A,{sx:{p:2,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",color:"#FFF"},children:[(0,r.jsx)(d.A,{variant:"body2",sx:{color:"#B0B0B0"},children:h(i)}),(0,r.jsx)(d.A,{variant:"h6",sx:{color:s,fontWeight:"bold"},children:o[0].value})]}):null};return(0,r.jsxs)(p.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"2px solid #2B2B2B",borderRadius:2},children:[(0,r.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,r.jsx)(d.A,{variant:"h6",sx:{color:"#FFD600",fontWeight:"bold"},children:o}),(0,r.jsx)(x.A,{label:l?"\uD83D\uDFE2 LIVE":"⚪",size:"small",sx:{backgroundColor:l?"#4CAF50":"#666",color:"#FFF",fontWeight:"bold",animation:l?"pulse 2s infinite":"none"}})]}),(0,r.jsx)(g.u,{width:"100%",height:n,children:"area"===i?(0,r.jsxs)(b.Q,{data:t,margin:{top:5,right:30,left:20,bottom:5},children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"gradient-".concat(o),x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"5%",stopColor:s,stopOpacity:.3}),(0,r.jsx)("stop",{offset:"95%",stopColor:s,stopOpacity:0})]})}),(0,r.jsx)(B.d,{strokeDasharray:"3 3",stroke:"#2B2B2B"}),(0,r.jsx)(k.W,{dataKey:"time",stroke:"#B0B0B0",fontSize:12,tickFormatter:h}),(0,r.jsx)(y.h,{stroke:"#B0B0B0",fontSize:12}),(0,r.jsx)(f.m,{content:(0,r.jsx)(u,{})}),(0,r.jsx)(v.Gk,{type:"monotone",dataKey:"value",stroke:s,strokeWidth:2,fill:"url(#gradient-".concat(o,")"),dot:{fill:s,strokeWidth:2,r:4},activeDot:{r:6,stroke:s,strokeWidth:2}})]}):(0,r.jsxs)(F.b,{data:t,margin:{top:5,right:30,left:20,bottom:5},children:[(0,r.jsx)(B.d,{strokeDasharray:"3 3",stroke:"#2B2B2B"}),(0,r.jsx)(k.W,{dataKey:"time",stroke:"#B0B0B0",fontSize:12,tickFormatter:h}),(0,r.jsx)(y.h,{stroke:"#B0B0B0",fontSize:12}),(0,r.jsx)(f.m,{content:(0,r.jsx)(u,{})}),(0,r.jsx)(w.N,{type:"monotone",dataKey:"value",stroke:s,strokeWidth:2,dot:{fill:s,strokeWidth:2,r:4},activeDot:{r:6,stroke:s,strokeWidth:2}})]})})]})}var S=o(46368),C=o(48563),D=o(37045),I=o(42047),W=o(36741),T=o(97516),E=o(95022),P=o(61205),U=o(41602),z=o(23820),L=o(17681),O=o(15240),M=o(73741),N=o(33495),R=o(21067);let K=e=>{switch(e){case"critical":return"#FF6B6B";case"high":return"#FF8C42";case"medium":return"#FFD600";case"low":return"#4CAF50";default:return"#B0B0B0"}};function H(e){let{activities:t,maxItems:o=20}=e,s=t.slice(0,o);return(0,r.jsxs)(p.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"2px solid #2B2B2B",borderRadius:2,height:"100%"},children:[(0,r.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,r.jsx)(i.A,{sx:{color:"#FFD600",mr:1}}),(0,r.jsx)(d.A,{variant:"h6",sx:{color:"#FFD600",fontWeight:"bold"},children:"Live Threat Activity"}),(0,r.jsx)(x.A,{label:"\uD83D\uDFE2 LIVE",size:"small",sx:{ml:"auto",backgroundColor:"#4CAF50",color:"#FFF",fontWeight:"bold",animation:"pulse 2s infinite"}})]}),(0,r.jsx)(U.A,{sx:{maxHeight:400,overflow:"auto"},children:0===s.length?(0,r.jsx)(z.Ay,{children:(0,r.jsx)(L.A,{primary:(0,r.jsx)(d.A,{sx:{color:"#B0B0B0",textAlign:"center"},children:"No recent threat activity"})})}):s.map((e,t)=>(0,r.jsxs)(j.Fragment,{children:[(0,r.jsxs)(z.Ay,{sx:{px:0},children:[(0,r.jsx)(O.A,{children:(0,r.jsx)(M.A,{sx:{backgroundColor:K(e.severity),width:40,height:40},children:(e=>{switch(e){case"critical":return(0,r.jsx)(C.A,{sx:{color:"#FF6B6B"}});case"high":return(0,r.jsx)(D.A,{sx:{color:"#FF8C42"}});case"medium":return(0,r.jsx)(I.A,{sx:{color:"#FFD600"}});case"low":return(0,r.jsx)(W.A,{sx:{color:"#4CAF50"}});default:return(0,r.jsx)(i.A,{sx:{color:"#B0B0B0"}})}})(e.severity)})}),(0,r.jsx)(L.A,{primary:(0,r.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[(0,r.jsx)(d.A,{variant:"body2",sx:{color:"#FFF",fontWeight:"bold"},children:e.attackType}),(0,r.jsx)(x.A,{label:e.severity.toUpperCase(),size:"small",sx:{backgroundColor:K(e.severity),color:"#000",fontWeight:"bold",fontSize:"0.7rem"}}),e.isBlocked&&(0,r.jsx)(N.A,{title:"Blocked",children:(0,r.jsx)(T.A,{sx:{color:"#FF6B6B",fontSize:16}})}),e.isAcknowledged&&(0,r.jsx)(N.A,{title:"Acknowledged",children:(0,r.jsx)(W.A,{sx:{color:"#4CAF50",fontSize:16}})})]}),secondary:(0,r.jsxs)(a.A,{children:[(0,r.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[(0,r.jsx)(E.A,{sx:{color:"#B0B0B0",fontSize:14}}),(0,r.jsxs)(d.A,{variant:"caption",sx:{color:"#B0B0B0",fontFamily:"monospace"},children:[e.sourceIP," → ",e.destinationIP]})]}),(0,r.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[(0,r.jsx)(P.A,{sx:{color:"#B0B0B0",fontSize:14}}),(0,r.jsxs)(d.A,{variant:"caption",sx:{color:"#B0B0B0"},children:[e.city,", ",e.country]})]}),(0,r.jsx)(d.A,{variant:"caption",sx:{color:"#B0B0B0"},children:e.description}),(0,r.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:.5},children:[(0,r.jsxs)(d.A,{variant:"caption",sx:{color:"#B0B0B0"},children:["Risk Score: ",e.riskScore,"/100"]}),(0,r.jsx)(d.A,{variant:"caption",sx:{color:"#B0B0B0"},children:(e=>{let t=new Date(e),o=new Date().getTime()-t.getTime(),r=Math.floor(o/6e4),s=Math.floor(o/36e5);return r<1?"Just now":r<60?"".concat(r,"m ago"):s<24?"".concat(s,"h ago"):t.toLocaleDateString()})(e.timestamp)})]})]})})]}),t<s.length-1&&(0,r.jsx)(R.A,{sx:{backgroundColor:"#2B2B2B",mx:2}})]},"".concat(e.timestamp,"-").concat(t)))})]})}var V=o(62890);function G(e){let{children:t,value:o,index:s,...i}=e;return(0,r.jsx)("div",{role:"tabpanel",hidden:o!==s,id:"monitor-tabpanel-".concat(s),"aria-labelledby":"monitor-tab-".concat(s),...i,children:o===s&&(0,r.jsx)(a.A,{sx:{pt:3},children:t})})}function q(){let[e,t]=(0,j.useState)(0),[o,g]=(0,j.useState)(!0),[b,B]=(0,j.useState)(new Date().toISOString().split("T")[0]),[k,y]=(0,j.useState)([]),[f,v]=(0,j.useState)({total_alerts:0,severity_breakdown:{},top_source_ips:[],top_attack_types:[],time_range_hours:24}),[F,w]=(0,j.useState)(!0),[C,D]=(0,j.useState)(null),I=(0,j.useCallback)(async()=>{try{w(!0),D(null);let e=(0,V.getSupabaseClient)();if(!e){D("Supabase client not available"),w(!1);return}let t=new Date(Date.now()-864e5).toISOString(),{data:o,error:r}=await e.from("security_alerts").select("*").gte("timestamp",t).order("timestamp",{ascending:!1}).limit(100);if(r){console.error("Error fetching alerts:",r),D("Failed to load alerts from database"),w(!1);return}if(!o||0===o.length){console.warn("No alerts returned from Supabase"),y([]),v({total_alerts:0,severity_breakdown:{},top_source_ips:[],top_attack_types:[],time_range_hours:24}),w(!1);return}y(o);let s={},i={},n={};o.forEach(e=>{let t=e.severity.toLowerCase();s[t]=(s[t]||0)+1,e.src_ip&&(i[e.src_ip]=(i[e.src_ip]||0)+1),e.detection_type&&(n[e.detection_type]=(n[e.detection_type]||0)+1)});let l=Object.entries(i).sort((e,t)=>t[1]-e[1]).slice(0,10),a=Object.entries(n).sort((e,t)=>t[1]-e[1]).slice(0,10);v({total_alerts:o.length,severity_breakdown:s,top_source_ips:l,top_attack_types:a,time_range_hours:24})}catch(e){console.error("Error fetching real-time data:",e),D("Failed to load real-time data. Please check your connection.")}finally{w(!1)}},[]);(0,j.useEffect)(()=>{I()},[I]),(0,j.useEffect)(()=>{if(!o)return;let e=setInterval(()=>{I()},5e3);return()=>clearInterval(e)},[o,I]);let W=(0,j.useCallback)(()=>{let e=new Date,t=[];for(let o=59;o>=0;o--){let r=new Date(e.getTime()-6e4*o),s=k.filter(e=>{let t=new Date(e.timestamp);return t>=r&&t<new Date(r.getTime()+6e4)}).length;t.push({time:r.toISOString(),value:s,timestamp:r.toISOString()})}return t},[k]),T={totalAlerts:f.total_alerts,criticalAlerts:f.severity_breakdown.critical||0,highAlerts:f.severity_breakdown.high||0,mediumAlerts:f.severity_breakdown.medium||0,lowAlerts:f.severity_breakdown.low||0,acknowledgedAlerts:k.filter(e=>e.is_acknowledged).length,activeThreats:k.filter(e=>!e.is_acknowledged&&!e.is_blocked).length,blockedIPs:new Set(k.filter(e=>e.is_blocked).map(e=>e.source_ip)).size};return(0,r.jsx)(S.A,{children:(0,r.jsxs)(c.A,{maxWidth:"xl",sx:{py:4},children:[(0,r.jsxs)(a.A,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)(a.A,{children:[(0,r.jsx)(d.A,{variant:"h3",sx:{fontWeight:700,color:"#FFD600",mb:1},children:"Real-time Monitor"}),(0,r.jsx)(d.A,{variant:"body1",sx:{color:"#B0B0B0"},children:"Live threat detection and system monitoring dashboard"})]}),(0,r.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[F&&(0,r.jsx)(x.A,{label:"\uD83D\uDD04 Loading...",sx:{backgroundColor:"#FFD600",color:"#000",fontWeight:"bold"}}),C&&(0,r.jsx)(x.A,{label:"❌ Error",sx:{backgroundColor:"#FF6B6B",color:"#FFF",fontWeight:"bold"}}),(0,r.jsx)(x.A,{label:o?"\uD83D\uDFE2 LIVE":"⚪ PAUSED",onClick:()=>g(!o),sx:{backgroundColor:o?"#4CAF50":"#666",color:"#FFF",fontWeight:"bold",cursor:"pointer",animation:o?"pulse 2s infinite":"none"}}),(0,r.jsx)(h.A,{onClick:()=>{I()},disabled:F,sx:{color:"#FFD600","&:hover":{backgroundColor:"rgba(255, 214, 0, 0.1)"},"&:disabled":{color:"#666"}},children:(0,r.jsx)(s.A,{})})]})]}),(0,r.jsx)(u.Ay,{container:!0,spacing:2,sx:{mb:4},children:[{label:"Total Alerts",value:T.totalAlerts,color:"#FFD600",icon:(0,r.jsx)(i.A,{})},{label:"Critical",value:T.criticalAlerts,color:"#FF6B6B",icon:(0,r.jsx)(i.A,{})},{label:"High",value:T.highAlerts,color:"#FF8C42",icon:(0,r.jsx)(i.A,{})},{label:"Active Threats",value:T.activeThreats,color:"#F44336",icon:(0,r.jsx)(i.A,{})},{label:"Blocked IPs",value:T.blockedIPs,color:"#9C27B0",icon:(0,r.jsx)(i.A,{})},{label:"Acknowledged",value:T.acknowledgedAlerts,color:"#4CAF50",icon:(0,r.jsx)(i.A,{})}].map(e=>(0,r.jsx)(u.Ay,{item:!0,xs:12,sm:6,md:2,children:(0,r.jsxs)(p.A,{sx:{p:2,backgroundColor:"#1A1A1A",border:"2px solid #2B2B2B",borderRadius:2,textAlign:"center"},children:[(0,r.jsx)(a.A,{sx:{color:e.color,mb:1},children:e.icon}),(0,r.jsx)(d.A,{variant:"body2",sx:{color:"#B0B0B0",mb:1},children:e.label}),(0,r.jsx)(d.A,{variant:"h5",sx:{color:e.color,fontWeight:700},children:e.value})]})},e.label))}),(0,r.jsxs)(p.A,{sx:{backgroundColor:"#1A1A1A",border:"2px solid #2B2B2B",borderRadius:2},children:[(0,r.jsxs)(A.A,{value:e,onChange:(e,o)=>{t(o)},sx:{borderBottom:"1px solid #2B2B2B","& .MuiTab-root":{color:"#B0B0B0","&.Mui-selected":{color:"#FFD600"}},"& .MuiTabs-indicator":{backgroundColor:"#FFD600"}},children:[(0,r.jsx)(m.A,{label:"Live Activity",icon:(0,r.jsx)(n.A,{}),iconPosition:"start"}),(0,r.jsx)(m.A,{label:"System Metrics",icon:(0,r.jsx)(l.A,{}),iconPosition:"start"}),(0,r.jsx)(m.A,{label:"Threat Feed",icon:(0,r.jsx)(i.A,{}),iconPosition:"start"})]}),(0,r.jsx)(G,{value:e,index:0,children:(0,r.jsx)(a.A,{sx:{p:3},children:(0,r.jsxs)(u.Ay,{container:!0,spacing:3,children:[(0,r.jsx)(u.Ay,{item:!0,xs:12,lg:8,children:(0,r.jsx)(_,{data:W(),title:"Alerts per Minute (Last Hour)",color:"#FFD600",type:"area",height:300})}),(0,r.jsx)(u.Ay,{item:!0,xs:12,lg:4,children:(0,r.jsx)(H,{activities:k.slice(0,10).map(e=>{var t;return{timestamp:e.timestamp||new Date().toISOString(),sourceIP:e.src_ip||e.source_ip||"Unknown",destinationIP:e.dest_ip||e.destination_ip||"Unknown",protocol:e.protocol||"Unknown",severity:(null==(t=e.severity)?void 0:t.toLowerCase())||"low",attackType:e.detection_type||e.attack_type||"Unknown",description:e.message||"No description",country:e.country||"Unknown",city:e.city||"Unknown",riskScore:e.risk_score||0,isBlocked:e.is_blocked||!1,isAcknowledged:e.is_acknowledged||!1}})})})]})})}),(0,r.jsx)(G,{value:e,index:1,children:(0,r.jsxs)(a.A,{sx:{p:3},children:[(0,r.jsx)(d.A,{variant:"h6",sx:{color:"#FFD600",fontWeight:"bold",mb:3},children:"System Metrics"}),(0,r.jsx)(d.A,{variant:"body1",sx:{color:"#B0B0B0"},children:"System metrics will be available when connected to the local Suricata database. This feature requires the sync service to be running and collecting system performance data."})]})}),(0,r.jsx)(G,{value:e,index:2,children:(0,r.jsx)(a.A,{sx:{p:3},children:(0,r.jsx)(H,{activities:k.map(e=>{var t;return{timestamp:e.timestamp||new Date().toISOString(),sourceIP:e.src_ip||e.source_ip||"Unknown",destinationIP:e.dest_ip||e.destination_ip||"Unknown",protocol:e.protocol||"Unknown",severity:(null==(t=e.severity)?void 0:t.toLowerCase())||"low",attackType:e.detection_type||e.attack_type||"Unknown",description:e.message||"No description",country:e.country||"Unknown",city:e.city||"Unknown",riskScore:e.risk_score||0,isBlocked:e.is_blocked||!1,isAcknowledged:e.is_acknowledged||!1}}),maxItems:50})})})]})]})})}}},e=>{e.O(0,[256,799,727,106,306,946,368,441,255,358],()=>e(e.s=58047)),_N_E=e.O()}]);