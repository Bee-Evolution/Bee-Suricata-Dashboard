(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{33442:(e,t,r)=>{Promise.resolve().then(r.bind(r,82277))},36300:(e,t,r)=>{"use strict";r.d(t,{b:()=>l});var s=r(95155),a=r(74512),n=r(93314),i=r(84563);let o=(0,a.A)({palette:{mode:"dark",primary:{main:"#FFD600",light:"#FFE54C",dark:"#F9A825",contrastText:"#000000"},secondary:{main:"#E0E0E0",contrastText:"#121212"},background:{default:"#121212",paper:"#1A1A1A"},text:{primary:"#E0E0E0",secondary:"#B0B0B0"},success:{main:"#4CAF50"},warning:{main:"#FF9800"},error:{main:"#F44336"},info:{main:"#2196F3"},divider:"#2B2B2B"},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"2.5rem",fontWeight:700,letterSpacing:"-0.02em"},h2:{fontSize:"2rem",fontWeight:700,letterSpacing:"-0.01em"},h4:{fontSize:"1.5rem",fontWeight:600},h6:{fontSize:"1rem",fontWeight:600},body1:{fontSize:"0.95rem",fontWeight:400},button:{fontWeight:600,textTransform:"none",letterSpacing:"0.5px"}},components:{MuiButton:{styleOverrides:{root:{borderRadius:"8px",transition:"all 0.2s ease-in-out"},contained:{"&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 16px rgba(255, 214, 0, 0.3)"}}}},MuiCard:{styleOverrides:{root:{backgroundColor:"#1A1A1A",borderRadius:"12px",border:"1px solid #2B2B2B"}}},MuiChip:{styleOverrides:{root:{fontWeight:600,fontSize:"0.85rem"}}}}});function l(e){let{children:t}=e;return(0,s.jsxs)(n.A,{theme:o,children:[(0,s.jsx)(i.Ay,{}),t]})}},82277:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eu});var s=r(95155),a=r(97322),n=r(80851),i=r(23315),o=r(28548),l=r(33077),c=r(29767),d=r(84578),u=r(61259),h=r(95125),x=r(12115),m=r(26991),p=r(80019),A=r(68425),b=r(47734),g=r(73697),y=r(33420),j=r(57095),f=r(4474),_=r(61023),B=r(52641),v=r(51221),S=r(48720),F=r(86973),w=r(43070),k=r(16963),C=r(2456),D=r(64792),E=r(71356),I=r(45202),T=r(62890);let O={http_basic_auth:"HTTP Basic Auth",http_form_auth:"HTTP Form Auth",ftp_auth:"FTP Auth",pop3_auth:"POP3 Auth",imap_auth:"IMAP Auth",telnet_auth:"Telnet Auth",ssh_bruteforce:"SSH Brute-Force",smb_ntlm:"SMB/NTLM Auth",port_scan:"Port Scan",malware_signature:"Malware Signature",unknown:"Unknown"},P={critical:"#F44336",high:"#FF6F00",medium:"#FFA726",low:"#FDD835",info:"#42A5F5"},W={critical:"Critical",high:"High",medium:"Medium",low:"Low",info:"Info"},M={http_basic_auth:"Cleartext HTTP Basic Authentication detected in Authorization header",http_form_auth:"HTTP POST request with form authentication fields detected",ftp_auth:"Cleartext FTP authentication credentials detected",pop3_auth:"Plaintext POP3 email authentication attempt detected",imap_auth:"Plaintext IMAP email authentication attempt detected",telnet_auth:"Telnet cleartext authentication detected (highly insecure)",ssh_bruteforce:"SSH brute-force attack detected on port 22",smb_ntlm:"SMB/NTLM authentication attempt or pass-the-hash detected",port_scan:"Network port scanning activity detected",malware_signature:"Known malware signature matched",unknown:"Unknown or uncategorized alert"};var z=r(51389),N=r(13315),H=r(21067),L=r(70690);let R=e=>{let{alert:t,open:r,onClose:a}=e;return t?(0,s.jsx)(N.Ay,{anchor:"right",open:r,onClose:a,children:(0,s.jsxs)(n.A,{sx:{width:500,p:3,background:"#121212",height:"100%",overflow:"auto"},children:[(0,s.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,s.jsx)(i.A,{variant:"h6",sx:{fontWeight:700},children:"Alert Details"}),(0,s.jsx)(z.A,{sx:{cursor:"pointer"},onClick:a})]}),(0,s.jsx)(H.A,{sx:{mb:2,borderColor:"#2B2B2B"}}),(0,s.jsxs)(n.A,{sx:{mb:3},children:[(0,s.jsx)(i.A,{variant:"body2",sx:{color:"#B0B0B0",mb:1},children:"Alert Type"}),(0,s.jsx)(i.A,{variant:"body1",sx:{mb:2,fontWeight:600},children:O[t.detection_type]}),(0,s.jsx)(o.A,{label:t.severity.toUpperCase(),sx:{backgroundColor:P[t.severity],color:"#000",fontWeight:700}})]}),(0,s.jsxs)(n.A,{sx:{mb:3},children:[(0,s.jsx)(i.A,{variant:"body2",sx:{color:"#B0B0B0",mb:1},children:"Description"}),(0,s.jsx)(i.A,{variant:"body2",children:M[t.detection_type]})]}),(0,s.jsx)(H.A,{sx:{my:2,borderColor:"#2B2B2B"}}),(0,s.jsxs)(n.A,{sx:{mb:3},children:[(0,s.jsx)(i.A,{variant:"subtitle2",sx:{fontWeight:700,mb:2},children:"Network Information"}),(0,s.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,s.jsxs)(l.Ay,{item:!0,xs:6,children:[(0,s.jsx)(i.A,{variant:"caption",sx:{color:"#B0B0B0"},children:"Source IP"}),(0,s.jsx)(i.A,{variant:"body2",sx:{fontFamily:"monospace"},children:t.source_ip})]}),(0,s.jsxs)(l.Ay,{item:!0,xs:6,children:[(0,s.jsx)(i.A,{variant:"caption",sx:{color:"#B0B0B0"},children:"Destination IP"}),(0,s.jsx)(i.A,{variant:"body2",sx:{fontFamily:"monospace"},children:t.destination_ip})]}),(0,s.jsxs)(l.Ay,{item:!0,xs:6,children:[(0,s.jsx)(i.A,{variant:"caption",sx:{color:"#B0B0B0"},children:"Source Port"}),(0,s.jsx)(i.A,{variant:"body2",children:t.source_port})]}),(0,s.jsxs)(l.Ay,{item:!0,xs:6,children:[(0,s.jsx)(i.A,{variant:"caption",sx:{color:"#B0B0B0"},children:"Destination Port"}),(0,s.jsx)(i.A,{variant:"body2",children:t.destination_port})]}),(0,s.jsxs)(l.Ay,{item:!0,xs:12,children:[(0,s.jsx)(i.A,{variant:"caption",sx:{color:"#B0B0B0"},children:"Protocol"}),(0,s.jsx)(i.A,{variant:"body2",children:t.protocol})]})]})]}),(0,s.jsx)(H.A,{sx:{my:2,borderColor:"#2B2B2B"}}),(0,s.jsxs)(n.A,{sx:{mb:3},children:[(0,s.jsx)(i.A,{variant:"body2",sx:{color:"#B0B0B0",mb:1},children:"Message"}),(0,s.jsx)(i.A,{variant:"body2",sx:{fontStyle:"italic"},children:t.message})]}),t.payload_snippet&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(H.A,{sx:{my:2,borderColor:"#2B2B2B"}}),(0,s.jsxs)(n.A,{sx:{mb:3},children:[(0,s.jsx)(i.A,{variant:"body2",sx:{color:"#B0B0B0",mb:1},children:"Payload Snippet"}),(0,s.jsx)(u.A,{sx:{p:2,backgroundColor:"#0A0A0A",border:"1px solid #2B2B2B",fontFamily:"monospace",fontSize:"0.85rem",maxHeight:200,overflow:"auto"},children:(0,s.jsx)(i.A,{variant:"body2",sx:{color:"#FFD600",fontFamily:"monospace"},children:t.payload_snippet})})]})]}),(0,s.jsx)(H.A,{sx:{my:2,borderColor:"#2B2B2B"}}),(0,s.jsxs)(n.A,{sx:{mb:3},children:[(0,s.jsx)(i.A,{variant:"body2",sx:{color:"#B0B0B0",mb:1},children:"Timestamps"}),(0,s.jsx)(k.A,{size:"small",children:(0,s.jsxs)(I.A,{children:[(0,s.jsxs)(D.A,{children:[(0,s.jsx)(E.A,{sx:{color:"#B0B0B0",border:"none",p:1},children:"Event Time:"}),(0,s.jsx)(E.A,{sx:{color:"#E0E0E0",border:"none",p:1,textAlign:"right"},children:new Date(t.timestamp).toLocaleString()})]}),(0,s.jsxs)(D.A,{children:[(0,s.jsx)(E.A,{sx:{color:"#B0B0B0",border:"none",p:1},children:"Created:"}),(0,s.jsx)(E.A,{sx:{color:"#E0E0E0",border:"none",p:1,textAlign:"right"},children:new Date(t.created_at).toLocaleString()})]}),(0,s.jsxs)(D.A,{children:[(0,s.jsx)(E.A,{sx:{color:"#B0B0B0",border:"none",p:1},children:"Updated:"}),(0,s.jsx)(E.A,{sx:{color:"#E0E0E0",border:"none",p:1,textAlign:"right"},children:new Date(t.updated_at).toLocaleString()})]})]})})]}),(0,s.jsx)(H.A,{sx:{my:2,borderColor:"#2B2B2B"}}),(0,s.jsx)(L.A,{fullWidth:!0,variant:"contained",sx:{mt:2,backgroundColor:"#FFD600",color:"#000",fontWeight:700,"&:hover":{backgroundColor:"#F9A825"}},children:"Acknowledge Alert"})]})}):null},q=()=>{let{alerts:e,loading:t}=function(){let[e,t]=(0,x.useState)([]),[r,s]=(0,x.useState)(!0),[a,n]=(0,x.useState)(null),i=(0,x.useCallback)(async()=>{try{s(!0);let e=(0,T.getSupabaseClient)();if(!e){n("Supabase not configured. Check your environment variables."),s(!1);return}let{data:r,error:a}=await e.from("security_alerts").select("*").order("timestamp",{ascending:!1}).limit(50);if(a)throw a;t(r||[]),n(null)}catch(e){n(e instanceof Error?e.message:"Failed to fetch alerts"),console.error("Error fetching alerts:",e)}finally{s(!1)}},[]);return(0,x.useEffect)(()=>{i();let e=(0,T.getSupabaseClient)();if(!e)return;let r=e.channel("alerts_channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"security_alerts"},e=>{t(t=>[e.new,...t].slice(0,50))}).subscribe();return()=>{r.unsubscribe()}},[i]),{alerts:e,loading:r,error:a,refetch:i}}(),[r,a]=(0,x.useState)(null),[c,d]=(0,x.useState)(!1),[h,m]=(0,x.useState)(""),[p,A]=(0,x.useState)("all"),[b,g]=(0,x.useState)("all"),y=(0,x.useMemo)(()=>e.filter(e=>{var t,r,s;let a=(null==(t=e.source_ip)?void 0:t.includes(h))||(null==(r=e.destination_ip)?void 0:r.includes(h))||(null==(s=e.message)?void 0:s.toLowerCase().includes(h.toLowerCase())),n="all"===p||e.severity===p,i="all"===b||e.detection_type===b;return a&&n&&i}),[e,h,p,b]);return t&&0===e.length?(0,s.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:300},children:(0,s.jsx)(f.A,{sx:{color:"#FFD600"}})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.Ay,{container:!0,spacing:2,sx:{mb:3},children:[(0,s.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,s.jsx)(_.A,{fullWidth:!0,placeholder:"Search by IP, message...",value:h,onChange:e=>m(e.target.value),sx:{"& .MuiOutlinedInput-root":{color:"#E0E0E0","& fieldset":{borderColor:"#2B2B2B"},"&:hover fieldset":{borderColor:"#FFD600"},"&.Mui-focused fieldset":{borderColor:"#FFD600"}}}})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsxs)(B.A,{fullWidth:!0,children:[(0,s.jsx)(v.A,{sx:{color:"#B0B0B0"},children:"Severity"}),(0,s.jsxs)(S.A,{value:p,onChange:e=>A(e.target.value),label:"Severity",sx:{color:"#E0E0E0","& .MuiOutlinedInput-notchedOutline":{borderColor:"#2B2B2B"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#FFD600"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#FFD600"}},children:[(0,s.jsx)(F.A,{value:"all",children:"All Severities"}),(0,s.jsx)(F.A,{value:"critical",children:"Critical"}),(0,s.jsx)(F.A,{value:"high",children:"High"}),(0,s.jsx)(F.A,{value:"medium",children:"Medium"}),(0,s.jsx)(F.A,{value:"low",children:"Low"}),(0,s.jsx)(F.A,{value:"info",children:"Info"})]})]})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsxs)(B.A,{fullWidth:!0,children:[(0,s.jsx)(v.A,{sx:{color:"#B0B0B0"},children:"Detection Type"}),(0,s.jsxs)(S.A,{value:b,onChange:e=>g(e.target.value),label:"Detection Type",sx:{color:"#E0E0E0","& .MuiOutlinedInput-notchedOutline":{borderColor:"#2B2B2B"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#FFD600"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#FFD600"}},children:[(0,s.jsx)(F.A,{value:"all",children:"All Types"}),(0,s.jsx)(F.A,{value:"http_basic_auth",children:"HTTP Basic Auth"}),(0,s.jsx)(F.A,{value:"http_form_auth",children:"HTTP Form Auth"}),(0,s.jsx)(F.A,{value:"ftp_auth",children:"FTP Auth"}),(0,s.jsx)(F.A,{value:"pop3_auth",children:"POP3 Auth"}),(0,s.jsx)(F.A,{value:"imap_auth",children:"IMAP Auth"}),(0,s.jsx)(F.A,{value:"telnet_auth",children:"Telnet Auth"}),(0,s.jsx)(F.A,{value:"ssh_bruteforce",children:"SSH Brute-Force"}),(0,s.jsx)(F.A,{value:"smb_ntlm",children:"SMB/NTLM Auth"})]})]})})]}),(0,s.jsxs)(i.A,{variant:"body2",sx:{color:"#B0B0B0",mb:2},children:["Showing ",y.length," of ",e.length," alerts"]}),(0,s.jsx)(w.A,{component:u.A,sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B"},children:(0,s.jsxs)(k.A,{children:[(0,s.jsx)(C.A,{children:(0,s.jsxs)(D.A,{sx:{backgroundColor:"#0A0A0A"},children:[(0,s.jsx)(E.A,{sx:{color:"#FFD600",fontWeight:700},children:"Timestamp"}),(0,s.jsx)(E.A,{sx:{color:"#FFD600",fontWeight:700},children:"Source IP"}),(0,s.jsx)(E.A,{sx:{color:"#FFD600",fontWeight:700},children:"Detection Type"}),(0,s.jsx)(E.A,{sx:{color:"#FFD600",fontWeight:700},children:"Severity"}),(0,s.jsx)(E.A,{sx:{color:"#FFD600",fontWeight:700},children:"Message"})]})}),(0,s.jsx)(I.A,{children:0===y.length?(0,s.jsx)(D.A,{children:(0,s.jsx)(E.A,{colSpan:5,sx:{textAlign:"center",py:4,color:"#B0B0B0"},children:"No alerts found"})}):y.map(e=>(0,s.jsxs)(D.A,{onClick:()=>{a(e),d(!0)},sx:{cursor:"pointer","&:hover":{backgroundColor:"#2B2B2B"},borderBottom:"1px solid #2B2B2B"},children:[(0,s.jsx)(E.A,{sx:{color:"#E0E0E0",fontSize:"0.85rem"},children:new Date(e.timestamp).toLocaleString()}),(0,s.jsx)(E.A,{sx:{color:"#E0E0E0",fontFamily:"monospace",fontSize:"0.85rem"},children:e.source_ip}),(0,s.jsx)(E.A,{sx:{color:"#FFD600",fontSize:"0.85rem"},children:O[e.detection_type]}),(0,s.jsx)(E.A,{children:(0,s.jsx)(o.A,{label:W[e.severity],size:"small",sx:{backgroundColor:P[e.severity],color:"low"===e.severity?"#000":"#fff",fontWeight:700}})}),(0,s.jsx)(E.A,{sx:{color:"#B0B0B0",maxWidth:300,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.message})]},e.id))})]})}),(0,s.jsx)(R,{alert:r,open:c,onClose:()=>d(!1)})]})};var U=r(12723),K=r(4035),Y=r(69386),G=r(37665);let J=["#FFD600","#FF6F00","#42A5F5","#66BB6A","#EF5350","#AB47BC","#FFA726","#26C6DA"],Q=()=>{let{distribution:e,loading:t,error:r}=function(){let[e,t]=(0,x.useState)([]),[r,s]=(0,x.useState)(!0),[a,n]=(0,x.useState)(null);return(0,x.useEffect)(()=>{(async()=>{try{s(!0);let e=(0,T.getSupabaseClient)();if(!e){n("Supabase not configured"),s(!1);return}let{data:r}=await e.from("security_alerts").select("attack_type").limit(1e3),a={};(r||[]).forEach(e=>{let t=e.attack_type||"Unknown";a[t]=(a[t]||0)+1});let i=Object.values(a).reduce((e,t)=>e+t,0),o=Object.entries(a).map(e=>{let[t,r]=e;return{type:t,count:r,percentage:r/i*100}}).sort((e,t)=>t.count-e.count).slice(0,8);t(o),n(null)}catch(e){n(e instanceof Error?e.message:"Failed to fetch distribution"),console.error("Error fetching distribution:",e)}finally{s(!1)}})()},[]),{distribution:e,loading:r,error:a}}();return t?(0,s.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:300},children:(0,s.jsx)(i.A,{children:"Loading distribution..."})}):r?(0,s.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:300},children:(0,s.jsxs)(i.A,{color:"error",children:["Error loading distribution: ",r]})}):e&&0!==e.length?(0,s.jsx)(m.u,{width:"100%",height:300,children:(0,s.jsxs)(U.r,{children:[(0,s.jsx)(K.F,{data:e,cx:"50%",cy:"40%",labelLine:!1,label:!1,outerRadius:90,innerRadius:25,fill:"#8884d8",dataKey:"count",paddingAngle:2,children:e.map((e,t)=>(0,s.jsx)(Y.f,{fill:J[t%J.length]},e.type||"cell-".concat(t)))}),(0,s.jsx)(y.m,{formatter:(e,t,r)=>["".concat(e," alerts (").concat(r.payload.percentage.toFixed(1),"%)"),r.payload.type||"Unknown"],labelStyle:{color:"#FFF"},contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:"8px",color:"#FFF"}}),(0,s.jsx)(G.s,{verticalAlign:"bottom",height:60,iconType:"circle",wrapperStyle:{paddingTop:"15px",fontSize:"13px",color:"#FFF",lineHeight:"1.4",fontWeight:"500"},formatter:(e,t)=>{let r=t.payload.percentage.toFixed(1);return"".concat(e," (").concat(r,"%)")}})]})}):(0,s.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:300},children:(0,s.jsx)(i.A,{color:"text.secondary",children:"No attack data available"})})};var V=r(98128),X=r(58155);let Z=()=>{let{topIps:e,loading:t,error:r}=function(){let[e,t]=(0,x.useState)([]),[r,s]=(0,x.useState)(!0),[a,n]=(0,x.useState)(null);return(0,x.useEffect)(()=>{(async()=>{try{s(!0);let e=(0,T.getSupabaseClient)();if(!e){n("Supabase not configured"),s(!1);return}let{data:r}=await e.from("security_alerts").select("src_ip, severity, timestamp").limit(1e3),a={};(r||[]).forEach(e=>{a[e.src_ip]||(a[e.src_ip]={count:0,maxSeverity:"info",lastSeen:e.timestamp}),a[e.src_ip].count+=1,a[e.src_ip].lastSeen=e.timestamp});let i=Object.entries(a).sort((e,t)=>{let[,r]=e,[,s]=t;return s.count-r.count}).slice(0,10).map(e=>{let[t,r]=e;return{ip:t,alert_count:r.count,severity:r.maxSeverity,last_seen:r.lastSeen}});t(i),n(null)}catch(e){n(e instanceof Error?e.message:"Failed to fetch top IPs"),console.error("Error fetching top IPs:",e)}finally{s(!1)}})()},[]),{topIps:e,loading:r,error:a}}();return t?(0,s.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:300},children:(0,s.jsx)(i.A,{children:"Loading top IPs..."})}):r?(0,s.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:300},children:(0,s.jsxs)(i.A,{color:"error",children:["Error loading top IPs: ",r]})}):e&&0!==e.length?(0,s.jsx)(m.u,{width:"100%",height:300,children:(0,s.jsxs)(V.E,{data:e,margin:{top:20,right:30,left:20,bottom:60},children:[(0,s.jsx)(A.d,{strokeDasharray:"3 3",stroke:"#2B2B2B"}),(0,s.jsx)(b.W,{dataKey:"ip",stroke:"#B0B0B0",angle:-45,textAnchor:"end",height:80,interval:0,fontSize:11}),(0,s.jsx)(g.h,{stroke:"#B0B0B0",domain:[0,"dataMax"],tickFormatter:e=>e.toString()}),(0,s.jsx)(y.m,{contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:"8px",color:"#FFF"},formatter:e=>["".concat(e," alerts"),"Alert Count"],labelFormatter:e=>"IP: ".concat(e)}),(0,s.jsx)(X.y,{dataKey:"alert_count",fill:"#FFD600",name:"Alert Count",radius:[4,4,0,0],maxBarSize:60})]})}):(0,s.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:300},children:(0,s.jsx)(i.A,{color:"text.secondary",children:"No IP data available"})})};var $=r(46368),ee=r(13143),et=r(60994),er=r(33843),es=r(85657),ea=r(41289);let en=e=>{let{label:t,value:r,icon:a,color:o,subtext:l}=e;return(0,s.jsxs)(u.A,{sx:{p:3,background:"linear-gradient(135deg, #1A1A1A 0%, #2B2B2B 100%)",border:"2px solid ".concat(o),borderRadius:2,display:"flex",alignItems:"center",gap:2},children:[(0,s.jsx)(n.A,{sx:{color:o,fontSize:32},children:a}),(0,s.jsxs)(n.A,{children:[(0,s.jsx)(i.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:t}),(0,s.jsx)(i.A,{variant:"h6",sx:{color:"#E0E0E0",fontWeight:700},children:r}),l&&(0,s.jsx)(i.A,{variant:"caption",sx:{color:"#B0B0B0"},children:l})]})]})},ei=()=>{let{stats:e,loading:t}=function(){let[e,t]=(0,x.useState)(null),[r,s]=(0,x.useState)(!0),[a,n]=(0,x.useState)(null);return(0,x.useEffect)(()=>{(async()=>{try{var e;s(!0);let r=(0,T.getSupabaseClient)();if(!r){n("Supabase not configured"),s(!1);return}let{count:a}=await r.from("security_alerts").select("*",{count:"exact",head:!0}),{count:i}=await r.from("security_alerts").select("*",{count:"exact",head:!0}).eq("severity","critical"),{data:o}=await r.from("security_alerts").select("src_ip"),l=new Set((o||[]).map(e=>e.src_ip)),{data:c}=await r.from("security_alerts").select("detection_type").limit(1e3),d={};(c||[]).forEach(e=>{d[e.detection_type]=(d[e.detection_type]||0)+1});let u=(null==(e=Object.entries(d).sort((e,t)=>{let[,r]=e,[,s]=t;return s-r})[0])?void 0:e[0])||null,h=new Date(Date.now()-864e5).toISOString(),{count:x}=await r.from("security_alerts").select("*",{count:"exact",head:!0}).gte("timestamp",h);t({total_alerts:a||0,critical_alerts:i||0,unique_source_ips:l.size,most_common_attack:u,alerts_last_24h:x||0,current_trend:"stable"}),n(null)}catch(e){n(e instanceof Error?e.message:"Failed to fetch stats"),console.error("Error fetching stats:",e)}finally{s(!1)}})()},[]),{stats:e,loading:r,error:a}}();return t?(0,s.jsx)(l.Ay,{container:!0,spacing:2,children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsxs)(u.A,{sx:{p:3,background:"#1A1A1A"},children:[(0,s.jsx)(ea.A,{height:40,sx:{mb:1}}),(0,s.jsx)(ea.A,{height:30,width:"60%"})]})},t))}):e?(0,s.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(en,{label:"Total Alerts",value:e.total_alerts,icon:(0,s.jsx)(er.A,{}),color:"#FFD600"})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(en,{label:"Critical Alerts",value:e.critical_alerts,icon:(0,s.jsx)(ee.A,{}),color:"#F44336",subtext:"".concat((e.critical_alerts/e.total_alerts*100).toFixed(1),"% of total")})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(en,{label:"Unique Source IPs",value:e.unique_source_ips,icon:(0,s.jsx)(et.A,{}),color:"#42A5F5"})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(en,{label:"Most Common",value:e.most_common_attack&&O[e.most_common_attack]?O[e.most_common_attack].split(" ")[0]:"N/A",icon:(0,s.jsx)(es.A,{}),color:"#FF9800",subtext:e.most_common_attack?"".concat(e.most_common_attack):"No data"})})]}):null};var eo=r(54466);class el{async getDashboardStats(){if(!this.supabase)return{total_alerts:0,critical_alerts:0,high_alerts:0,medium_alerts:0,low_alerts:0,unique_attackers:0,alerts_last_hour:0,alerts_last_24h:0,database_status:"disconnected",last_updated:new Date().toISOString()};try{let{count:e}=await this.supabase.from("security_alerts").select("*",{count:"exact",head:!0}),[t,r,s,a]=await Promise.all([this.supabase.from("security_alerts").select("*",{count:"exact",head:!0}).eq("severity","critical"),this.supabase.from("security_alerts").select("*",{count:"exact",head:!0}).eq("severity","high"),this.supabase.from("security_alerts").select("*",{count:"exact",head:!0}).eq("severity","medium"),this.supabase.from("security_alerts").select("*",{count:"exact",head:!0}).eq("severity","low")]),{data:n}=await this.supabase.from("security_alerts").select("src_ip"),i=new Set((n||[]).map(e=>e.src_ip)),o=new Date(Date.now()-36e5).toISOString(),{count:l}=await this.supabase.from("security_alerts").select("*",{count:"exact",head:!0}).gte("timestamp",o),c=new Date(Date.now()-864e5).toISOString(),{count:d}=await this.supabase.from("security_alerts").select("*",{count:"exact",head:!0}).gte("timestamp",c);return{total_alerts:e||0,critical_alerts:t.count||0,high_alerts:r.count||0,medium_alerts:s.count||0,low_alerts:a.count||0,unique_attackers:i.size,alerts_last_hour:l||0,alerts_last_24h:d||0,database_status:"connected",last_updated:new Date().toISOString()}}catch(e){return console.error("Error fetching dashboard stats:",e),{total_alerts:0,critical_alerts:0,high_alerts:0,medium_alerts:0,low_alerts:0,unique_attackers:0,alerts_last_hour:0,alerts_last_24h:0,database_status:"error",last_updated:new Date().toISOString()}}}async getTimeSeriesData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;if(!this.supabase)return[];try{let t=new Date(Date.now()-60*e*6e4).toISOString(),{data:r}=await this.supabase.from("security_alerts").select("timestamp").gte("timestamp",t).order("timestamp",{ascending:!0});if(!r)return[];let s={},a=new Date;for(let t=e-1;t>=0;t--){let e=new Date(a.getTime()-60*t*6e4);s["".concat(e.toISOString().slice(0,13),":00:00")]=0}return r.forEach(e=>{let t="".concat(new Date(e.timestamp).toISOString().slice(0,13),":00:00");void 0!==s[t]&&s[t]++}),Object.entries(s).map(e=>{let[t,r]=e;return{time:new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),count:r}})}catch(e){return console.error("Error fetching time series data:",e),[]}}async getAttackDistribution(){if(!this.supabase)return[];try{let{data:e}=await this.supabase.from("security_alerts").select("attack_type").limit(1e3);if(!e)return[];let t={};e.forEach(e=>{let r=e.attack_type||"Unknown";t[r]=(t[r]||0)+1});let r=Object.values(t).reduce((e,t)=>e+t,0);return Object.entries(t).map(e=>{let[t,s]=e;return{type:t,count:s,percentage:s/r*100}}).sort((e,t)=>t.count-e.count).slice(0,10)}catch(e){return console.error("Error fetching attack distribution:",e),[]}}async getTopAttackers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;if(!this.supabase)return[];try{let{data:t}=await this.supabase.from("security_alerts").select("src_ip, severity, timestamp, country").limit(1e3);if(!t)return[];let r={};return t.forEach(e=>{r[e.src_ip]||(r[e.src_ip]={count:0,maxSeverity:"info",lastSeen:e.timestamp,country:e.country}),r[e.src_ip].count+=1,r[e.src_ip].lastSeen=e.timestamp;let t={critical:4,high:3,medium:2,low:1,info:0};t[e.severity]>t[r[e.src_ip].maxSeverity]&&(r[e.src_ip].maxSeverity=e.severity)}),Object.entries(r).sort((e,t)=>{let[,r]=e,[,s]=t;return s.count-r.count}).slice(0,e).map(e=>{let[t,r]=e;return{ip:t,alert_count:r.count,severity:r.maxSeverity,last_seen:r.lastSeen,country:r.country}})}catch(e){return console.error("Error fetching top attackers:",e),[]}}async getRecentAlerts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;if(!this.supabase)return[];try{let{data:t}=await this.supabase.from("security_alerts").select("*").order("timestamp",{ascending:!1}).limit(e);if(!t)return[];return t.map(e=>({id:e.id,timestamp:e.timestamp,severity:e.severity,source_ip:e.src_ip,destination_ip:e.dest_ip,attack_type:e.attack_type,message:e.message,risk_score:e.risk_score||0}))}catch(e){return console.error("Error fetching recent alerts:",e),[]}}async getSystemStatus(){if(!this.supabase)return{database_connected:!1,api_status:"down",uptime:"N/A",version:"2.0.0",last_health_check:new Date().toISOString()};try{let{data:e,error:t}=await this.supabase.from("security_alerts").select("count").limit(1);return{database_connected:!t,api_status:t?"degraded":"operational",uptime:"99.9%",version:"2.0.0",last_health_check:new Date().toISOString()}}catch(e){return{database_connected:!1,api_status:"down",uptime:"N/A",version:"2.0.0",last_health_check:new Date().toISOString()}}}subscribeToAlerts(e){return this.supabase?this.supabase.channel("dashboard_alerts").on("postgres_changes",{event:"INSERT",schema:"public",table:"security_alerts"},t=>{let r=t.new;e({id:r.id,timestamp:r.timestamp,severity:r.severity,source_ip:r.source_ip,destination_ip:r.destination_ip,attack_type:r.attack_type,message:r.message,risk_score:r.risk_score||0})}).subscribe():null}subscribeToStats(e){return this.supabase?this.supabase.channel("dashboard_stats").on("postgres_changes",{event:"*",schema:"public",table:"security_alerts"},async()=>{e(await this.getDashboardStats())}).subscribe():null}constructor(){this.supabase=(0,T.getSupabaseClient)()}}let ec=new el;var ed=r(36300);function eu(){var e;let{connectionState:t}=(0,eo.w)(),[r,f]=(0,x.useState)([]),[_,B]=(0,x.useState)(null),[v,S]=(0,x.useState)(null),[F,w]=(0,x.useState)(!0),k=(0,x.useCallback)(async()=>{try{w(!0);let[e,t,r]=await Promise.all([ec.getDashboardStats(),ec.getTimeSeriesData(24),ec.getSystemStatus()]);S(e),f(t),B(r);try{let t="http://localhost:8000",[r,s]=await Promise.all([h.A.get("".concat(t,"/api/analytics/dashboard"),{timeout:5e3}),h.A.get("".concat(t,"/api/status"),{timeout:5e3})]);"disconnected"===e.database_status&&r.data.hourly_data&&f(r.data.hourly_data),"disconnected"===e.database_status&&B(s.data)}catch(e){console.log("Backend API not available, using Supabase data only")}}catch(e){console.error("Failed to fetch dashboard data:",e)}finally{w(!1)}},[]);return(0,x.useEffect)(()=>{k();let e=setInterval(k,6e4);return()=>clearInterval(e)},[k]),(0,s.jsx)(ed.b,{children:(0,s.jsx)($.A,{children:(0,s.jsxs)(a.A,{maxWidth:"xl",sx:{py:4},children:[(0,s.jsxs)(n.A,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,s.jsxs)(n.A,{children:[(0,s.jsx)(i.A,{variant:"h3",sx:{fontWeight:700,color:"#FFD600",mb:1,letterSpacing:"-0.02em"},children:"Security Intelligence Dashboard"}),(0,s.jsx)(i.A,{variant:"body1",sx:{color:"#B0B0B0"},children:"Real-time monitoring of network intrusion attempts and authentication attacks"})]}),_&&(0,s.jsx)(o.A,{label:"".concat(t.supabaseConnected?"\uD83D\uDFE2":"\uD83D\uDD34"," ").concat(t.backendConnected?"System Healthy":"System Issues"),sx:{backgroundColor:t.supabaseConnected?"#4CAF50":"#F44336",color:"#FFF"}})]}),(0,s.jsx)(n.A,{sx:{mb:4},children:(0,s.jsx)(ei,{})}),(0,s.jsx)(l.Ay,{container:!0,spacing:2,sx:{mb:4},children:[{label:"Database Status",value:t.supabaseConnected?"Connected":"Disconnected",color:t.supabaseConnected?"#4CAF50":"#F44336"},{label:"API Status",value:t.backendConnected?"Operational":"Issues",color:t.backendConnected?"#4CAF50":"#F44336"},{label:"Alerts Last Hour",value:(null==v||null==(e=v.alerts_last_hour)?void 0:e.toString())||"0",color:"#FFD600"},{label:"System Uptime",value:(null==_?void 0:_.uptime)||"N/A",color:"#2196F3"}].map(e=>(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(c.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B"},children:(0,s.jsxs)(d.A,{sx:{py:2},children:[(0,s.jsx)(i.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:e.label}),(0,s.jsx)(i.A,{variant:"h6",sx:{color:e.color,fontWeight:700},children:F?"...":e.value})]})})},e.label))}),r.length>0&&(0,s.jsxs)(u.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",mb:4},children:[(0,s.jsx)(i.A,{variant:"h6",sx:{fontWeight:700,mb:2,color:"#FFD600"},children:"Alert Trend (Last 24 Hours)"}),(0,s.jsx)(m.u,{width:"100%",height:250,children:(0,s.jsxs)(p.b,{data:r,children:[(0,s.jsx)(A.d,{strokeDasharray:"3 3",stroke:"#2B2B2B"}),(0,s.jsx)(b.W,{dataKey:"time",stroke:"#B0B0B0"}),(0,s.jsx)(g.h,{stroke:"#B0B0B0"}),(0,s.jsx)(y.m,{contentStyle:{backgroundColor:"#2B2B2B",border:"none"}}),(0,s.jsx)(j.N,{type:"monotone",dataKey:"count",stroke:"#FFD600",strokeWidth:2,dot:!1})]})})]}),(0,s.jsxs)(l.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,s.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,s.jsxs)(u.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:2},children:[(0,s.jsx)(i.A,{variant:"h6",sx:{fontWeight:700,mb:2,color:"#FFD600"},children:"Attack Type Distribution"}),(0,s.jsx)(Q,{})]})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,s.jsxs)(u.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:2},children:[(0,s.jsx)(i.A,{variant:"h6",sx:{fontWeight:700,mb:2,color:"#FFD600"},children:"Top Attacking IPs"}),(0,s.jsx)(Z,{})]})})]}),(0,s.jsxs)(n.A,{children:[(0,s.jsx)(i.A,{variant:"h6",sx:{fontWeight:700,mb:2,color:"#FFD600"},children:"Recent Alerts"}),(0,s.jsx)(u.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:2,overflow:"hidden"},children:(0,s.jsx)(n.A,{sx:{p:3},children:(0,s.jsx)(q,{})})})]})]})})})}}},e=>{e.O(0,[256,799,125,845,727,532,550,622,946,368,441,255,358],()=>e(e.s=33442)),_N_E=e.O()}]);