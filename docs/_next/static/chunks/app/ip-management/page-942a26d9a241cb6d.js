(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[942],{49528:(e,t,a)=>{Promise.resolve().then(a.bind(a,84177))},75183:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(95125);class r{getApiUrl(){let e="http://localhost:8000";{let t=localStorage.getItem("dashboardConfig");if(t)try{let a=JSON.parse(t);a.apiUrl&&(e=a.apiUrl)}catch(e){console.warn("Failed to parse saved config for API URL:",e)}}return e.endsWith("/api")&&(e=e.replace("/api","")),"".concat(e,"/api")}async login(e){console.log("API login called with:",e);let t=await this.api.post("/auth/login",e);return console.log("API login response:",t.data),t.data}async validateToken(){return(await this.api.post("/auth/validate")).data}async logout(){return(await this.api.post("/auth/logout")).data}async getCurrentUser(){return(await this.api.get("/auth/me")).data}async getHealth(){return(await this.api.get("/health")).data}async getStatus(){return(await this.api.get("/status")).data}async getAlerts(){var e,t;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=new URLSearchParams({page:s.toString(),pageSize:r.toString()});return(null==(e=a.severity)?void 0:e.length)&&i.append("severity",a.severity.join(",")),(null==(t=a.detection_type)?void 0:t.length)&&i.append("detection_type",a.detection_type.join(",")),a.timeRange&&i.append("timeRange",a.timeRange),a.search&&i.append("search",a.search),(await this.api.get("/alerts?".concat(i.toString()))).data}async getAlertById(e){return(await this.api.get("/alerts/".concat(e))).data}async acknowledgeAlert(e){return(await this.api.patch("/alerts/".concat(e,"/acknowledge"))).data}async getDashboardStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"24hours";return(await this.api.get("/dashboard/stats?time_range=".concat(e))).data}async getAnalytics(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[e,t,a,s,r]=await Promise.all([this.api.get("/dashboard/stats"),this.api.get("/analytics/timeline?days=7"),this.api.get("/analytics/severity-distribution"),this.api.get("/analytics/attack-types"),this.api.get("/analytics/geographic")]);return{data:{total_alerts:e.data.totalAlerts||0,critical_alerts:e.data.criticalAlerts||0,high_alerts:0,medium_alerts:0,unique_attackers:e.data.uniqueAttackers||0,hourly_data:t.data||[],severity_breakdown:a.data||[],attack_types:s.data||[],top_countries:r.data||[],top_protocols:[]},success:!0}}async getAlertTimeline(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days",t=parseInt(e.replace(/[^0-9]/g,""),10)||7;return(await this.api.get("/analytics/timeline?days=".concat(t))).data}async getSeverityDistribution(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days";return(await this.api.get("/analytics/severity-distribution?time_range=".concat(e))).data}async getAttackDistribution(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days";return(await this.api.get("/analytics/attack-types?time_range=".concat(e))).data}async getTopIps(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await this.api.get("/analytics/protocol-stats?limit=".concat(e))).data}async generateSampleData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(await this.api.post("/database/generate-sample",{count:e})).data}async clearAlerts(){return(await this.api.delete("/alerts")).data}async testConnection(){return(await this.api.get("/database/test-connection")).data}async initializeDatabase(){return(await this.api.post("/database/initialize")).data}async seedDatabase(){return(await this.api.post("/db/seed")).data}async resetDatabase(){return(await this.api.post("/db/reset")).data}async getSystemStatus(){return(await this.api.get("/status")).data}async getRealtimeAlerts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;return(await this.api.get("/local/realtime/alerts?limit=".concat(e,"&hours=").concat(t))).data}async getRealtimeStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;return(await this.api.get("/local/realtime/stats?hours=".concat(e))).data}async getLocalDatabaseInfo(){return(await this.api.get("/local/database/info")).data}async parseSuricataLog(e){let t=new FormData;return t.append("log_file",e),(await this.api.post("/local/suricata/parse-log",t,{headers:{"Content-Type":"multipart/form-data"}})).data}async generateSampleSuricataLog(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(await this.api.post("/local/suricata/generate-sample?count=".concat(e))).data}async getSyncStatus(){return(await this.api.get("/sync/status")).data}async startSyncService(){return(await this.api.post("/sync/start")).data}async stopSyncService(){return(await this.api.post("/sync/stop")).data}async forceSyncNow(){return(await this.api.post("/sync/force-sync")).data}refreshApiService(){this.baseURL=this.getApiUrl(),this.api=s.A.create({baseURL:this.baseURL,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{let t=localStorage.getItem("matseka_auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e})}async getIPManagementStats(){return this.api.get("/ip-management/stats")}async getAllIPs(){return this.api.get("/ip-management/ips")}async getLoginAttempts(e){return this.api.get(e?"/ip-management/login-attempts?ip=".concat(e):"/ip-management/login-attempts")}async getIPDetails(e){return this.api.get("/ip-management/ip/".concat(e,"/details"))}async blockIP(e){return this.api.post("/ip-management/block",e)}async whitelistIP(e){return this.api.post("/ip-management/whitelist",e)}async unblockIP(e){return this.api.post("/ip-management/unblock",e)}async checkIPStatus(e){return this.api.get("/ip-management/check/".concat(e))}async detectNetworkInfo(){return this.api.get("/network/detect")}async getSuricataConfig(){return this.api.get("/network/config")}async updateHomeNetworks(e){return this.api.put("/network/config/home-networks",e)}async updateNetworkInterface(e){return this.api.put("/network/config/interface",e)}async updatePortGroups(e){return this.api.put("/network/config/ports",e)}async validateSuricataConfig(){return this.api.post("/network/config/validate")}async restoreSuricataConfig(){return this.api.post("/network/config/restore")}async getProtocolStatistics(){return this.api.get("/analytics/protocol-details")}getBaseURL(){return this.baseURL}isConnected(){return!!this.baseURL}constructor(){this.baseURL=this.getApiUrl(),console.log("\uD83D\uDD17 API Service initialized"),console.log("\uD83D\uDCCD Base URL: ".concat(this.baseURL)),console.log("\uD83D\uDCA1 If this URL is wrong, clear localStorage: localStorage.removeItem('dashboardConfig')"),this.api=s.A.create({baseURL:this.baseURL,timeout:3e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{let t=localStorage.getItem("matseka_auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),this.api.interceptors.request.use(e=>{var t;return console.log("API Request: ".concat(null==(t=e.method)?void 0:t.toUpperCase()," ").concat(e.url)),e},e=>(console.error("API Request Error:",e),Promise.reject(e))),this.api.interceptors.response.use(e=>(console.log("API Response: ".concat(e.status," ").concat(e.config.url)),e),e=>{if("ERR_NETWORK"===e.code||"Network Error"===e.message)console.error("âŒ NETWORK ERROR - Cannot reach backend API"),console.error("Attempted URL: ".concat(this.baseURL)),console.error("Possible causes:"),console.error("1. Backend server not running (expected: http://localhost:8000)"),console.error("2. Wrong API URL in localStorage (check 'dashboardConfig')"),console.error("3. CORS policy blocking the request"),console.error("4. Firewall or network issue"),console.error("\nTo fix: Run in browser console:"),console.error("  localStorage.getItem('dashboardConfig')"),console.error("  localStorage.removeItem('dashboardConfig') // if URL is wrong"),console.error("  location.reload()");else{var t;console.error("API Response Error:",e),(null==(t=e.response)?void 0:t.status)===404&&console.warn("API endpoint not found - backend may not be running")}return Promise.reject(e)})}}let i=new r},84177:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>H});var s=a(95155),r=a(14041),i=a(97516),n=a(37045),o=a(36741),l=a(76530),c=a(36697);let d=(0,c.A)((0,s.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"}),"LockOpen"),h=(0,c.A)((0,s.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1z"}),"Lock");var x=a(57430),g=a(80851),p=a(23315),u=a(97322),A=a(78010),m=a(33077),j=a(61259),y=a(63103),b=a(80121),k=a(55369),f=a(26466),F=a(70690),w=a(43070),v=a(16963),S=a(2456),I=a(64792),B=a(71356),P=a(45202),C=a(28548),E=a(33495),D=a(41983),R=a(2778),L=a(52363),W=a(65036),_=a(61023),U=a(75912),z=a(12115),M=a(46368),T=a(75183);function N(e){let{children:t,value:a,index:r,...i}=e;return(0,s.jsx)("div",{role:"tabpanel",hidden:a!==r,id:"ip-management-tabpanel-".concat(r),"aria-labelledby":"ip-management-tab-".concat(r),...i,children:a===r&&(0,s.jsx)(g.A,{sx:{p:3},children:t})})}function H(){let[e,t]=(0,z.useState)(0),[a,c]=(0,z.useState)(null),[H,O]=(0,z.useState)([]),[q,V]=(0,z.useState)([]),[K,G]=(0,z.useState)(!0),[J,Q]=(0,z.useState)(null),[X,Y]=(0,z.useState)(null),[Z,$]=(0,z.useState)(!1),[ee,et]=(0,z.useState)(""),[ea,es]=(0,z.useState)(!0),er=(0,z.useCallback)(async()=>{try{G(!0);let[e,t,a]=await Promise.all([T.A.getIPManagementStats(),T.A.getAllIPs(),T.A.getLoginAttempts()]);c(e.data||e),O(t.data||t||[]),V(a.data||a||[]),Q(null)}catch(e){Q("Failed to fetch IP management data"),console.error("Error fetching data:",e),O([]),V([])}finally{G(!1)}},[]);(0,z.useEffect)(()=>{er();let e=setInterval(er,3e4);return()=>clearInterval(e)},[er]);let ei=async(e,t)=>{try{await T.A.blockIP({ip:e,blockType:"temporary",reason:t}),$(!1),et(""),er()}catch(e){Q("Failed to block IP address")}},en=async e=>{try{await T.A.unblockIP(e),er()}catch(e){Q("Failed to unblock IP address")}},eo=async e=>{try{await T.A.whitelistIP({ip:e,reason:"Whitelisted by admin"}),er()}catch(e){Q("Failed to whitelist IP address")}},el=async e=>{try{await T.A.blockIP({ip:e,blockType:"permanent",reason:"Permanently blocked due to repeated violations"}),er()}catch(e){Q("Failed to permanently block IP address")}};return K?(0,s.jsx)(M.A,{children:(0,s.jsx)(g.A,{sx:{p:3},children:(0,s.jsx)(p.A,{children:"Loading IP Management data..."})})}):(0,s.jsx)(M.A,{children:(0,s.jsxs)(u.A,{maxWidth:"xl",sx:{py:4},children:[(0,s.jsx)(g.A,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"start"},children:(0,s.jsxs)(g.A,{children:[(0,s.jsx)(p.A,{variant:"h3",sx:{fontWeight:700,color:"#FFD600",mb:1,letterSpacing:"-0.02em"},children:"IP Management & Authentication Security"}),(0,s.jsx)(p.A,{variant:"body1",sx:{color:"#B0B0B0"},children:"Monitor and manage IP addresses, track login attempts, and configure security policies"})]})}),J&&(0,s.jsx)(A.A,{severity:"error",sx:{mb:3},onClose:()=>Q(null),children:J}),a&&(0,s.jsx)(g.A,{sx:{mb:4},children:(0,s.jsxs)(m.Ay,{container:!0,spacing:2,children:[(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsxs)(j.A,{sx:{p:3,background:"linear-gradient(135deg, #1A1A1A 0%, #2B2B2B 100%)",border:"2px solid #FFD600",borderRadius:2,display:"flex",alignItems:"center",gap:2,minHeight:120},children:[(0,s.jsx)(g.A,{sx:{color:"#FFD600",fontSize:32},children:(0,s.jsx)(r.A,{})}),(0,s.jsxs)(g.A,{children:[(0,s.jsx)(p.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"Total IPs"}),(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#E0E0E0",fontWeight:700},children:a.totalIPs})]})]})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsxs)(j.A,{sx:{p:3,background:"linear-gradient(135deg, #1A1A1A 0%, #2B2B2B 100%)",border:"2px solid #F44336",borderRadius:2,display:"flex",alignItems:"center",gap:2,minHeight:120},children:[(0,s.jsx)(g.A,{sx:{color:"#F44336",fontSize:32},children:(0,s.jsx)(i.A,{})}),(0,s.jsxs)(g.A,{children:[(0,s.jsx)(p.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"Blocked IPs"}),(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#E0E0E0",fontWeight:700},children:a.blockedIPs})]})]})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsxs)(j.A,{sx:{p:3,background:"linear-gradient(135deg, #1A1A1A 0%, #2B2B2B 100%)",border:"2px solid #FF9800",borderRadius:2,display:"flex",alignItems:"center",gap:2,minHeight:120},children:[(0,s.jsx)(g.A,{sx:{color:"#FF9800",fontSize:32},children:(0,s.jsx)(n.A,{})}),(0,s.jsxs)(g.A,{children:[(0,s.jsx)(p.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"Failed Logins"}),(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#E0E0E0",fontWeight:700},children:a.failedAttempts||0})]})]})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsxs)(j.A,{sx:{p:3,background:"linear-gradient(135deg, #1A1A1A 0%, #2B2B2B 100%)",border:"2px solid #4CAF50",borderRadius:2,display:"flex",alignItems:"center",gap:2,minHeight:120},children:[(0,s.jsx)(g.A,{sx:{color:"#4CAF50",fontSize:32},children:(0,s.jsx)(o.A,{})}),(0,s.jsxs)(g.A,{children:[(0,s.jsx)(p.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"Whitelisted"}),(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#E0E0E0",fontWeight:700},children:a.whitelistedIPs})]})]})})]})}),(0,s.jsx)(j.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:2,mb:4},children:(0,s.jsxs)(g.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)(g.A,{children:[(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#FFD600",mb:1,fontWeight:700},children:"Auto Block System"}),(0,s.jsx)(p.A,{variant:"body2",sx:{color:"#B0B0B0"},children:"Automatically block IPs after 3 failed login attempts"})]}),(0,s.jsx)(y.A,{control:(0,s.jsx)(b.A,{checked:ea,onChange:e=>es(e.target.checked),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#FFD600"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#FFD600"}}}),label:""})]})}),(0,s.jsxs)(j.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:2,mb:4},children:[(0,s.jsx)(g.A,{sx:{borderBottom:1,borderColor:"#2B2B2B"},children:(0,s.jsxs)(k.A,{value:e,onChange:(e,a)=>{t(a)},sx:{"& .MuiTab-root":{color:"#B0B0B0","&.Mui-selected":{color:"#FFD600"}},"& .MuiTabs-indicator":{backgroundColor:"#FFD600"}},children:[(0,s.jsx)(f.A,{label:"IP Addresses"}),(0,s.jsx)(f.A,{label:"Login Attempts"}),(0,s.jsx)(f.A,{label:"Authentication Security"})]})}),(0,s.jsxs)(N,{value:e,index:0,children:[(0,s.jsxs)(g.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#FFD600",fontWeight:700},children:"IP Address Management"}),(0,s.jsx)(F.A,{startIcon:(0,s.jsx)(l.A,{}),onClick:er,sx:{color:"#FFD600",borderColor:"#FFD600","&:hover":{borderColor:"#F9A825",backgroundColor:"#FFD60020"}},variant:"outlined",children:"Refresh"})]}),(0,s.jsx)(w.A,{component:j.A,sx:{backgroundColor:"#0D0D0D",border:"1px solid #2B2B2B"},children:(0,s.jsxs)(v.A,{children:[(0,s.jsx)(S.A,{children:(0,s.jsxs)(I.A,{children:[(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"IP Address"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Status"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Risk Score"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Location"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Last Seen"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Actions"})]})}),(0,s.jsx)(P.A,{children:H.map(e=>{var t;return(0,s.jsxs)(I.A,{children:[(0,s.jsx)(B.A,{sx:{color:"#E0E0E0"},children:e.ip}),(0,s.jsx)(B.A,{children:(0,s.jsx)(C.A,{label:e.isBlocked?"blocked":e.isWhitelisted?"whitelisted":"monitored",color:(e=>{switch(e){case"blocked":return"error";case"whitelisted":return"success";case"monitored":return"warning";default:return"default"}})(e.isBlocked?"blocked":e.isWhitelisted?"whitelisted":"monitored"),size:"small"})}),(0,s.jsx)(B.A,{children:(0,s.jsx)(C.A,{label:"".concat(e.riskScore,"%"),color:(t=e.riskScore)>=80?"error":t>=60?"warning":t>=40?"info":"success",size:"small"})}),(0,s.jsx)(B.A,{sx:{color:"#E0E0E0"},children:e.country||"Unknown"}),(0,s.jsx)(B.A,{sx:{color:"#E0E0E0"},children:new Date(e.lastSeen).toLocaleString()}),(0,s.jsx)(B.A,{children:(0,s.jsxs)(g.A,{sx:{display:"flex",gap:1},children:[e.isBlocked?(0,s.jsx)(E.A,{title:"Unblock IP",children:(0,s.jsx)(D.A,{size:"small",onClick:()=>en(e.ip),sx:{color:"#4CAF50"},children:(0,s.jsx)(d,{})})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.A,{title:"Block IP",children:(0,s.jsx)(D.A,{size:"small",onClick:()=>{Y(e),$(!0)},sx:{color:"#F44336"},children:(0,s.jsx)(i.A,{})})}),(0,s.jsx)(E.A,{title:"Permanent Block",children:(0,s.jsx)(D.A,{size:"small",onClick:()=>el(e.ip),sx:{color:"#D32F2F"},children:(0,s.jsx)(h,{})})})]}),(0,s.jsx)(E.A,{title:"Whitelist IP",children:(0,s.jsx)(D.A,{size:"small",onClick:()=>eo(e.ip),sx:{color:"#4CAF50"},children:(0,s.jsx)(o.A,{})})})]})})]},e.ip)})})]})})]}),(0,s.jsxs)(N,{value:e,index:1,children:[(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#FFD600",mb:2,fontWeight:700},children:"Recent Login Attempts"}),(0,s.jsx)(w.A,{component:j.A,sx:{backgroundColor:"#0D0D0D",border:"1px solid #2B2B2B"},children:(0,s.jsxs)(v.A,{children:[(0,s.jsx)(S.A,{children:(0,s.jsxs)(I.A,{children:[(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"IP Address"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Username"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Status"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Attempts"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Last Attempt"}),(0,s.jsx)(B.A,{sx:{color:"#FFD600",fontWeight:600},children:"Actions"})]})}),(0,s.jsx)(P.A,{children:q.map((e,t)=>(0,s.jsxs)(I.A,{children:[(0,s.jsx)(B.A,{sx:{color:"#E0E0E0"},children:e.ip}),(0,s.jsx)(B.A,{sx:{color:"#E0E0E0"},children:e.username}),(0,s.jsx)(B.A,{children:(0,s.jsx)(C.A,{label:e.success?"Success":"Failed",color:e.success?"success":"error",size:"small"})}),(0,s.jsx)(B.A,{sx:{color:"#E0E0E0"},children:e.attemptCount}),(0,s.jsx)(B.A,{sx:{color:"#E0E0E0"},children:new Date(e.timestamp).toLocaleString()}),(0,s.jsx)(B.A,{children:(0,s.jsxs)(g.A,{sx:{display:"flex",gap:1},children:[e.attemptCount>=3&&!e.success&&(0,s.jsx)(E.A,{title:"Block IP",children:(0,s.jsx)(D.A,{size:"small",onClick:()=>{Y({id:"temp-".concat(e.ip),ip:e.ip,isBlocked:!1,isWhitelisted:!1,riskScore:0,lastSeen:new Date().toISOString(),type:"source",alertCount:0}),et("Multiple failed login attempts"),$(!0)},sx:{color:"#F44336"},children:(0,s.jsx)(i.A,{})})}),(0,s.jsx)(E.A,{title:"View Details",children:(0,s.jsx)(D.A,{size:"small",onClick:()=>{},sx:{color:"#FFD600"},children:(0,s.jsx)(x.A,{})})})]})})]},t))})]})})]}),(0,s.jsxs)(N,{value:e,index:2,children:[(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#FFD600",mb:2,fontWeight:700},children:"Authentication Security Settings"}),(0,s.jsxs)(m.Ay,{container:!0,spacing:3,children:[(0,s.jsx)(m.Ay,{item:!0,xs:12,md:6,children:(0,s.jsxs)(j.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:2},children:[(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#FFD600",mb:2,fontWeight:700},children:"Login Protection"}),(0,s.jsx)(g.A,{sx:{mb:2},children:(0,s.jsx)(y.A,{control:(0,s.jsx)(b.A,{defaultChecked:!0}),label:"Enable auto-block after 3 failed attempts",sx:{color:"#E0E0E0"}})}),(0,s.jsx)(g.A,{sx:{mb:2},children:(0,s.jsx)(y.A,{control:(0,s.jsx)(b.A,{defaultChecked:!0}),label:"Permanent block after 5 failed attempts",sx:{color:"#E0E0E0"}})}),(0,s.jsx)(g.A,{sx:{mb:2},children:(0,s.jsx)(y.A,{control:(0,s.jsx)(b.A,{}),label:"Email notifications for blocked IPs",sx:{color:"#E0E0E0"}})})]})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,md:6,children:(0,s.jsxs)(j.A,{sx:{p:3,backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:2},children:[(0,s.jsx)(p.A,{variant:"h6",sx:{color:"#FFD600",mb:2,fontWeight:700},children:"Security Statistics"}),(0,s.jsx)(g.A,{sx:{mb:2},children:(0,s.jsxs)(p.A,{variant:"body2",color:"textSecondary",children:["Total blocked IPs today:"," ",(0,s.jsx)("strong",{style:{color:"#F44336"},children:"12"})]})}),(0,s.jsx)(g.A,{sx:{mb:2},children:(0,s.jsxs)(p.A,{variant:"body2",color:"textSecondary",children:["Failed login attempts today:"," ",(0,s.jsx)("strong",{style:{color:"#FF9800"},children:"47"})]})}),(0,s.jsx)(g.A,{sx:{mb:2},children:(0,s.jsxs)(p.A,{variant:"body2",color:"textSecondary",children:["Auto-blocked IPs:"," ",(0,s.jsx)("strong",{style:{color:"#F44336"},children:"8"})]})}),(0,s.jsx)(g.A,{sx:{mb:2},children:(0,s.jsxs)(p.A,{variant:"body2",color:"textSecondary",children:["Manually unblocked:"," ",(0,s.jsx)("strong",{style:{color:"#4CAF50"},children:"3"})]})})]})})]})]})]}),(0,s.jsxs)(R.A,{open:Z,onClose:()=>$(!1),children:[(0,s.jsx)(L.A,{sx:{color:"#FFD600"},children:"Block IP Address"}),(0,s.jsxs)(W.A,{children:[(0,s.jsxs)(p.A,{sx:{mb:2},children:["Block IP: ",(0,s.jsx)("strong",{children:null==X?void 0:X.ip})]}),(0,s.jsx)(_.A,{autoFocus:!0,margin:"dense",label:"Reason for blocking",fullWidth:!0,variant:"outlined",value:ee,onChange:e=>et(e.target.value),sx:{mt:2}})]}),(0,s.jsxs)(U.A,{children:[(0,s.jsx)(F.A,{onClick:()=>$(!1),children:"Cancel"}),(0,s.jsx)(F.A,{onClick:()=>X&&ei(X.ip,ee),variant:"contained",sx:{backgroundColor:"#F44336"},children:"Block IP"})]})]})]})})}}},e=>{e.O(0,[256,799,125,106,667,550,946,368,441,255,358],()=>e(e.s=49528)),_N_E=e.O()}]);