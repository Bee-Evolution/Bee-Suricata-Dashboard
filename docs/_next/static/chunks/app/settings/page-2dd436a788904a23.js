(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{14256:(e,t,a)=>{Promise.resolve().then(a.bind(a,82417))},35116:(e,t,a)=>{"use strict";a.d(t,{ConfigProvider:()=>i,U:()=>l});var r=a(95155),o=a(12115);let s=(0,o.createContext)(void 0),n={supabaseUrl:"https://your-project.supabase.co",supabaseKey:"your-anon-key",apiUrl:"http://localhost:8000",isConfigured:!1},i=e=>{let{children:t}=e,[i,l]=(0,o.useState)(n),[c,d]=(0,o.useState)(!1);(0,o.useEffect)(()=>{{let e=localStorage.getItem("dashboardConfig");if(e)try{let t=JSON.parse(e);l(e=>({...e,...t,isConfigured:!0}))}catch(e){console.error("Failed to parse saved config:",e)}}},[]),(0,o.useEffect)(()=>{i.isConfigured&&localStorage.setItem("dashboardConfig",JSON.stringify(i))},[i]);let u=async()=>{d(!0);try{let{createClient:e}=await Promise.resolve().then(a.bind(a,11993)),t=e(i.supabaseUrl,i.supabaseKey),{data:r,error:o}=await t.from("security_alerts").select("count").limit(1);if(o)return{success:!1,message:"Supabase connection failed: ".concat(o.message)};try{let e=await fetch("".concat(i.apiUrl,"/api/status"),{method:"GET",timeout:5e3});if(!e.ok)return{success:!1,message:"Backend API connection failed: ".concat(e.status," ").concat(e.statusText)}}catch(e){return{success:!1,message:"Backend API connection failed: ".concat(e instanceof Error?e.message:"Unknown error")}}return{success:!0,message:"Both Supabase and Backend API connections successful!"}}catch(e){return{success:!1,message:"Connection test failed: ".concat(e instanceof Error?e.message:"Unknown error")}}finally{d(!1)}};return(0,r.jsx)(s.Provider,{value:{config:i,updateConfig:e=>{l(t=>({...t,...e,isConfigured:!0}))},resetToDefaults:()=>{l(n),localStorage.removeItem("dashboardConfig")},testConnection:u,isTesting:c,saveConfig:()=>{localStorage.setItem("dashboardConfig",JSON.stringify({...i,isConfigured:!0}))},refreshServices:()=>{window.location.reload()}},children:t})},l=()=>{let e=(0,o.useContext)(s);if(void 0===e)throw Error("useConfig must be used within a ConfigProvider");return e}},36300:(e,t,a)=>{"use strict";a.d(t,{b:()=>l});var r=a(95155),o=a(74512),s=a(93314),n=a(84563);let i=(0,o.A)({palette:{mode:"dark",primary:{main:"#FFD600",light:"#FFE54C",dark:"#F9A825",contrastText:"#000000"},secondary:{main:"#E0E0E0",contrastText:"#121212"},background:{default:"#121212",paper:"#1A1A1A"},text:{primary:"#E0E0E0",secondary:"#B0B0B0"},success:{main:"#4CAF50"},warning:{main:"#FF9800"},error:{main:"#F44336"},info:{main:"#2196F3"},divider:"#2B2B2B"},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"2.5rem",fontWeight:700,letterSpacing:"-0.02em"},h2:{fontSize:"2rem",fontWeight:700,letterSpacing:"-0.01em"},h4:{fontSize:"1.5rem",fontWeight:600},h6:{fontSize:"1rem",fontWeight:600},body1:{fontSize:"0.95rem",fontWeight:400},button:{fontWeight:600,textTransform:"none",letterSpacing:"0.5px"}},components:{MuiButton:{styleOverrides:{root:{borderRadius:"8px",transition:"all 0.2s ease-in-out"},contained:{"&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 16px rgba(255, 214, 0, 0.3)"}}}},MuiCard:{styleOverrides:{root:{backgroundColor:"#1A1A1A",borderRadius:"12px",border:"1px solid #2B2B2B"}}},MuiChip:{styleOverrides:{root:{fontWeight:600,fontSize:"0.85rem"}}}}});function l(e){let{children:t}=e;return(0,r.jsxs)(s.A,{theme:i,children:[(0,r.jsx)(n.Ay,{}),t]})}},75183:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(95125);class o{getApiUrl(){let e="http://localhost:8000";{let t=localStorage.getItem("dashboardConfig");if(t)try{let a=JSON.parse(t);a.apiUrl&&(e=a.apiUrl)}catch(e){console.warn("Failed to parse saved config for API URL:",e)}}return e.endsWith("/api")&&(e=e.replace("/api","")),"".concat(e,"/api")}async login(e){console.log("API login called with:",e);let t=await this.api.post("/auth/login",e);return console.log("API login response:",t.data),t.data}async validateToken(){return(await this.api.post("/auth/validate")).data}async logout(){return(await this.api.post("/auth/logout")).data}async getCurrentUser(){return(await this.api.get("/auth/me")).data}async getHealth(){return(await this.api.get("/health")).data}async getStatus(){return(await this.api.get("/status")).data}async getAlerts(){var e,t;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,s=new URLSearchParams({page:r.toString(),pageSize:o.toString()});return(null==(e=a.severity)?void 0:e.length)&&s.append("severity",a.severity.join(",")),(null==(t=a.detection_type)?void 0:t.length)&&s.append("detection_type",a.detection_type.join(",")),a.timeRange&&s.append("timeRange",a.timeRange),a.search&&s.append("search",a.search),(await this.api.get("/alerts?".concat(s.toString()))).data}async getAlertById(e){return(await this.api.get("/alerts/".concat(e))).data}async acknowledgeAlert(e){return(await this.api.patch("/alerts/".concat(e,"/acknowledge"))).data}async getDashboardStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"24hours";return(await this.api.get("/dashboard/stats?time_range=".concat(e))).data}async getAnalytics(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[e,t,a,r,o]=await Promise.all([this.api.get("/dashboard/stats"),this.api.get("/analytics/timeline?days=7"),this.api.get("/analytics/severity-distribution"),this.api.get("/analytics/attack-types"),this.api.get("/analytics/geographic")]);return{data:{total_alerts:e.data.totalAlerts||0,critical_alerts:e.data.criticalAlerts||0,high_alerts:0,medium_alerts:0,unique_attackers:e.data.uniqueAttackers||0,hourly_data:t.data||[],severity_breakdown:a.data||[],attack_types:r.data||[],top_countries:o.data||[],top_protocols:[]},success:!0}}async getAlertTimeline(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days",t=parseInt(e.replace(/[^0-9]/g,""),10)||7;return(await this.api.get("/analytics/timeline?days=".concat(t))).data}async getSeverityDistribution(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days";return(await this.api.get("/analytics/severity-distribution?time_range=".concat(e))).data}async getAttackDistribution(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days";return(await this.api.get("/analytics/attack-types?time_range=".concat(e))).data}async getTopIps(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await this.api.get("/analytics/protocol-stats?limit=".concat(e))).data}async generateSampleData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(await this.api.post("/database/generate-sample",{count:e})).data}async clearAlerts(){return(await this.api.delete("/alerts")).data}async testConnection(){return(await this.api.get("/database/test-connection")).data}async initializeDatabase(){return(await this.api.post("/database/initialize")).data}async seedDatabase(){return(await this.api.post("/db/seed")).data}async resetDatabase(){return(await this.api.post("/db/reset")).data}async getSystemStatus(){return(await this.api.get("/status")).data}async getRealtimeAlerts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;return(await this.api.get("/local/realtime/alerts?limit=".concat(e,"&hours=").concat(t))).data}async getRealtimeStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;return(await this.api.get("/local/realtime/stats?hours=".concat(e))).data}async getLocalDatabaseInfo(){return(await this.api.get("/local/database/info")).data}async parseSuricataLog(e){let t=new FormData;return t.append("log_file",e),(await this.api.post("/local/suricata/parse-log",t,{headers:{"Content-Type":"multipart/form-data"}})).data}async generateSampleSuricataLog(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(await this.api.post("/local/suricata/generate-sample?count=".concat(e))).data}async getSyncStatus(){return(await this.api.get("/sync/status")).data}async startSyncService(){return(await this.api.post("/sync/start")).data}async stopSyncService(){return(await this.api.post("/sync/stop")).data}async forceSyncNow(){return(await this.api.post("/sync/force-sync")).data}refreshApiService(){this.baseURL=this.getApiUrl(),this.api=r.A.create({baseURL:this.baseURL,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{let t=localStorage.getItem("matseka_auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e})}async getIPManagementStats(){return this.api.get("/ip-management/stats")}async getAllIPs(){return this.api.get("/ip-management/ips")}async getLoginAttempts(e){return this.api.get(e?"/ip-management/login-attempts?ip=".concat(e):"/ip-management/login-attempts")}async getIPDetails(e){return this.api.get("/ip-management/ip/".concat(e,"/details"))}async blockIP(e){return this.api.post("/ip-management/block",e)}async whitelistIP(e){return this.api.post("/ip-management/whitelist",e)}async unblockIP(e){return this.api.post("/ip-management/unblock",e)}async checkIPStatus(e){return this.api.get("/ip-management/check/".concat(e))}async detectNetworkInfo(){return this.api.get("/network/detect")}async getSuricataConfig(){return this.api.get("/network/config")}async updateHomeNetworks(e){return this.api.put("/network/config/home-networks",e)}async updateNetworkInterface(e){return this.api.put("/network/config/interface",e)}async updatePortGroups(e){return this.api.put("/network/config/ports",e)}async validateSuricataConfig(){return this.api.post("/network/config/validate")}async restoreSuricataConfig(){return this.api.post("/network/config/restore")}async getProtocolStatistics(){return this.api.get("/analytics/protocol-details")}getBaseURL(){return this.baseURL}isConnected(){return!!this.baseURL}constructor(){this.baseURL=this.getApiUrl(),console.log("\uD83D\uDD17 API Service initialized"),console.log("\uD83D\uDCCD Base URL: ".concat(this.baseURL)),console.log("\uD83D\uDCA1 If this URL is wrong, clear localStorage: localStorage.removeItem('dashboardConfig')"),this.api=r.A.create({baseURL:this.baseURL,timeout:3e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{let t=localStorage.getItem("matseka_auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),this.api.interceptors.request.use(e=>{var t;return console.log("API Request: ".concat(null==(t=e.method)?void 0:t.toUpperCase()," ").concat(e.url)),e},e=>(console.error("API Request Error:",e),Promise.reject(e))),this.api.interceptors.response.use(e=>(console.log("API Response: ".concat(e.status," ").concat(e.config.url)),e),e=>{if("ERR_NETWORK"===e.code||"Network Error"===e.message)console.error("❌ NETWORK ERROR - Cannot reach backend API"),console.error("Attempted URL: ".concat(this.baseURL)),console.error("Possible causes:"),console.error("1. Backend server not running (expected: http://localhost:8000)"),console.error("2. Wrong API URL in localStorage (check 'dashboardConfig')"),console.error("3. CORS policy blocking the request"),console.error("4. Firewall or network issue"),console.error("\nTo fix: Run in browser console:"),console.error("  localStorage.getItem('dashboardConfig')"),console.error("  localStorage.removeItem('dashboardConfig') // if URL is wrong"),console.error("  location.reload()");else{var t;console.error("API Response Error:",e),(null==(t=e.response)?void 0:t.status)===404&&console.warn("API endpoint not found - backend may not be running")}return Promise.reject(e)})}}let s=new o},82417:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var r=a(95155),o=a(97322),s=a(80851),n=a(23315),i=a(78010),l=a(61259),c=a(70690),d=a(21067),u=a(61023),h=a(4474),p=a(33077),g=a(63103),x=a(80121),m=a(2778),b=a(52363),A=a(65036),f=a(52005),y=a(28548),v=a(75912),C=a(12115),F=a(36300),j=a(46368),k=a(35116),w=a(54466),S=a(75183);function B(){let{config:e,updateConfig:t,resetToDefaults:a,testConnection:B,isTesting:D,saveConfig:I,refreshServices:W}=(0,k.U)(),{connectionState:R,checkConnections:N}=(0,w.w)(),[E,P]=(0,C.useState)({autoRefresh:!0,refreshInterval:30,alertThreshold:"Medium",emailNotifications:!0,emailAddress:"admin@example.com",slackNotifications:!1,slackWebhook:""}),[_,T]=(0,C.useState)(!1),[U,O]=(0,C.useState)(!1),[M,L]=(0,C.useState)(!1),[z,J]=(0,C.useState)(!1),[G,H]=(0,C.useState)(null),[q,K]=(0,C.useState)(null),[V,Y]=(0,C.useState)(!1),[Q,X]=(0,C.useState)({homeNetworks:["192.168.0.0/16","10.0.0.0/8","172.16.0.0/12"],interface:"eth0",portGroups:{http_ports:[80,443,8080,8443,8888,9443],ssh_ports:[22],ftp_ports:[21],smtp_ports:[25],dns_ports:[53]}}),[Z,$]=(0,C.useState)(null),[ee,et]=(0,C.useState)(!1),[ea,er]=(0,C.useState)(!1),[eo,es]=(0,C.useState)({eveJsonPath:"/var/log/suricata/eve.json",autoReload:!0}),[en,ei]=(0,C.useState)(!1),[el,ec]=(0,C.useState)({open:!1,title:"",message:"",progress:0,showProgress:!1}),[ed,eu]=(0,C.useState)({open:!1,title:"",message:"",type:"success",details:""}),eh=(0,C.useCallback)(async()=>{Y(!0);try{await N();try{let e=await S.A.getSystemStatus();K(e.data)}catch(e){K({database:{connected:R.supabaseConnected},api:{status:R.backendConnected?"operational":"disconnected"},uptime:"N/A",version:"1.0.0"})}}catch(e){console.error("Failed to fetch system status:",e),K({database:{connected:R.supabaseConnected},api:{status:R.backendConnected?"operational":"disconnected"},uptime:"N/A",version:"1.0.0"})}finally{Y(!1)}},[N,R.supabaseConnected,R.backendConnected]),ep=(0,C.useCallback)(async()=>{try{let e=await S.A.getSuricataConfig();e.data.success&&X({homeNetworks:e.data.data.home_networks||["192.168.0.0/16","10.0.0.0/8","172.16.0.0/12"],interface:e.data.data.interface||"eth0",portGroups:e.data.data.port_groups||{http_ports:[80,443,8080,8443,8888,9443],ssh_ports:[22],ftp_ports:[21],smtp_ports:[25],dns_ports:[53]}})}catch(t){var e;console.error("Failed to fetch network configuration:",t),(null==(e=t.response)?void 0:e.status)===503&&(H("Network configuration service not available. Please ensure all dependencies are installed."),setTimeout(()=>H(null),5e3))}},[]),eg=(0,C.useCallback)(async()=>{et(!0);try{let e=await S.A.detectNetworkInfo();e.data.success&&$(e.data.data)}catch(t){var e;console.error("Failed to detect network info:",t),(null==(e=t.response)?void 0:e.status)===503&&(H("Network detection service not available. Please ensure psutil is installed."),setTimeout(()=>H(null),5e3))}finally{et(!1)}},[]);(0,C.useEffect)(()=>{let e=localStorage.getItem("dashboardSettings");if(e)try{let t=JSON.parse(e);P(e=>({...e,...t}))}catch(e){console.error("Failed to parse saved settings:",e)}eh(),ep(),eg()},[eg,ep,eh]);let ex=e=>{X({...Q,interface:e})},em=async()=>{er(!0);try{await S.A.updateHomeNetworks(Q.homeNetworks),await S.A.updateNetworkInterface(Q.interface),await S.A.updatePortGroups(Q.portGroups),H("Network configuration saved successfully!"),setTimeout(()=>H(null),3e3)}catch(e){H("Failed to save network configuration: ".concat(e.message)),setTimeout(()=>H(null),5e3)}finally{er(!1)}},eb=async()=>{ei(!0);try{let t=await fetch("".concat(e.apiUrl,"/api/config/suricata"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eve_json_path:eo.eveJsonPath,auto_reload:eo.autoReload})});if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));ev("Configuration Saved","Suricata configuration saved successfully!","success","EVE JSON file path and auto-reload settings have been updated.")}catch(e){ev("Save Failed","Failed to save Suricata configuration","error",e.message)}finally{ei(!1)}},eA=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];ec({open:!0,title:e,message:t,progress:0,showProgress:a})},ef=e=>{ec(t=>({...t,progress:e}))},ey=()=>{ec(e=>({...e,open:!1}))},ev=function(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";eu({open:!0,title:e,message:t,type:a,details:r})},eC=()=>{eu(e=>({...e,open:!1}))},eF=(e,t)=>{P({...E,[e]:t}),T(!1)},ej=async()=>{try{localStorage.setItem("dashboardSettings",JSON.stringify(E)),T(!0),setTimeout(()=>T(!1),3e3)}catch(e){console.error("Failed to save settings:",e)}},ek=async()=>{eA("Testing Connection","Checking database connectivity...");try{let e=await S.A.testConnection();ey(),e.data.success?ev("Connection Successful","Database connection test completed successfully!","success","Status: ".concat(e.data.message,"\nTimestamp: ").concat(e.data.timestamp)):ev("Connection Failed","Database connection test failed.","error","Error: ".concat(e.data.message))}catch(e){ey(),ev("Connection Error","Failed to test database connection.","error","Error: ".concat(e.message||"Unknown error occurred"))}},ew=async()=>{eC(),eA("Clearing Alerts","Removing all alert records...",!0);let e=0,t=setInterval(()=>{ef(e=Math.min(e+15,90))},150);try{let e=await S.A.clearAlerts();clearInterval(t),ef(100),setTimeout(()=>{ey(),e.data.success?ev("Alerts Cleared","All alerts have been cleared successfully!","success","Deleted: ".concat(e.data.deleted_count," alerts")):ev("Clear Failed","Failed to clear alerts.","error","The operation could not be completed.")},500)}catch(e){clearInterval(t),ey(),ev("Clear Error","Failed to clear alerts.","error","Error: ".concat(e.message||"Unknown error occurred"))}},eS=async()=>{eC(),eA("Resetting Database","Removing all data and resetting database...",!0);let e=0,t=setInterval(()=>{ef(e=Math.min(e+6,90))},400);try{let e=await S.A.resetDatabase();clearInterval(t),ef(100),setTimeout(()=>{ey(),e.data.success?ev("Database Reset","Database has been reset successfully!","success","Message: ".concat(e.data.message)):ev("Reset Failed","Failed to reset database.","error","Error: ".concat(e.data.message))},500)}catch(e){clearInterval(t),ey(),ev("Reset Error","Failed to reset database.","error","Error: ".concat(e.message||"Unknown error occurred"))}};return(0,r.jsx)(F.b,{children:(0,r.jsxs)(j.A,{children:[(0,r.jsxs)(o.A,{maxWidth:"md",sx:{py:4},children:[(0,r.jsxs)(s.A,{sx:{mb:4},children:[(0,r.jsx)(n.A,{variant:"h3",sx:{fontWeight:700,color:"#FFD600",mb:1},children:"⚙️ Settings"}),(0,r.jsx)(n.A,{variant:"body1",sx:{color:"#B0B0B0"},children:"Configuration and management"})]}),_&&(0,r.jsx)(i.A,{severity:"success",sx:{mb:3},children:"Settings saved successfully!"}),G&&(0,r.jsx)(i.A,{severity:G.includes("successful")?"success":"error",sx:{mb:3},children:G}),(0,r.jsxs)(l.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",p:3,mb:3},children:[(0,r.jsx)(n.A,{variant:"h6",sx:{fontWeight:700,color:"#FFD600",mb:3},children:"\uD83C\uDFE0 Home Network Configuration"}),(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:3},children:"Configure your home network settings and Suricata interface detection"}),(0,r.jsxs)(s.A,{sx:{mb:4},children:[(0,r.jsx)(n.A,{variant:"subtitle1",sx:{fontWeight:600,color:"#FFD600",mb:2},children:"\uD83D\uDD0D Network Detection"}),(0,r.jsxs)(s.A,{sx:{display:"flex",gap:2,mb:3,flexWrap:"wrap"},children:[(0,r.jsx)(c.A,{variant:"outlined",onClick:eg,disabled:ee,sx:{borderColor:"#4CAF50",color:"#4CAF50",fontWeight:700,"&:hover":{borderColor:"#45A049",backgroundColor:"#4CAF5020"}},children:ee?"Detecting...":"\uD83D\uDD0D Detect Network"}),(0,r.jsx)(c.A,{variant:"outlined",onClick:em,disabled:ea,sx:{borderColor:"#FFD600",color:"#FFD600",fontWeight:700,"&:hover":{borderColor:"#F9A825",backgroundColor:"#FFD60020"}},children:ea?"Saving...":"\uD83D\uDCBE Save Configuration"})]}),Z&&(0,r.jsxs)(s.A,{sx:{backgroundColor:"#0D0D0D",border:"1px solid #2B2B2B",borderRadius:1,p:2,mb:3},children:[(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:1},children:"Detected Interfaces:"}),Object.entries(Z.interfaces||{}).map(e=>{var t,a;let[o,i]=e;return(0,r.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,r.jsx)(s.A,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:i.is_up?"#4CAF50":"#F44336"}}),(0,r.jsxs)(n.A,{variant:"body2",sx:{color:"#FFF"},children:[o,": ",(null==(a=i.addresses)||null==(t=a[0])?void 0:t.ip)||"No IP"," ",i.is_up?"(Up)":"(Down)"]})]},o)})]})]}),(0,r.jsx)(d.A,{sx:{borderColor:"#2B2B2B",my:3}}),(0,r.jsxs)(s.A,{sx:{mb:4},children:[(0,r.jsx)(n.A,{variant:"subtitle1",sx:{fontWeight:600,color:"#FFD600",mb:2},children:"\uD83D\uDD0C Network Interface"}),(0,r.jsx)(u.A,{label:"Interface Name",value:Q.interface,onChange:e=>ex(e.target.value),placeholder:"eth0",fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{color:"#FFF","& fieldset":{borderColor:"#2B2B2B"}}}}),(null==Z?void 0:Z.interfaces)&&(0,r.jsxs)(s.A,{sx:{mt:2},children:[(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:1},children:"Available Interfaces:"}),(0,r.jsx)(s.A,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:Object.keys(Z.interfaces).map(e=>(0,r.jsx)(c.A,{variant:Q.interface===e?"contained":"outlined",size:"small",onClick:()=>ex(e),sx:{backgroundColor:Q.interface===e?"#FFD600":"transparent",color:Q.interface===e?"#000":"#FFD600",borderColor:"#FFD600","&:hover":{backgroundColor:Q.interface===e?"#F9A825":"#FFD60020"}},children:e},e))})]})]}),(0,r.jsx)(d.A,{sx:{borderColor:"#2B2B2B",my:3}}),(0,r.jsxs)(s.A,{children:[(0,r.jsx)(n.A,{variant:"subtitle1",sx:{fontWeight:600,color:"#FFD600",mb:2},children:"\uD83D\uDD0C Port Groups"}),(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:2},children:"Configure port groups for different services. Separate multiple ports with commas."}),Object.entries(Q.portGroups).map(e=>{let[t,a]=e;return(0,r.jsx)(s.A,{sx:{mb:2},children:(0,r.jsx)(u.A,{label:t.replace("_"," ").toUpperCase(),value:a.join(", "),onChange:e=>{let a=e.target.value.split(",").map(e=>parseInt(e.trim(),10)).filter(e=>!Number.isNaN(e));X({...Q,portGroups:{...Q.portGroups,[t]:a}})},placeholder:"80, 443, 8080",fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{color:"#FFF","& fieldset":{borderColor:"#2B2B2B"}}}})},t)})]})]}),(0,r.jsxs)(l.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",p:3,mb:3},children:[(0,r.jsx)(n.A,{variant:"h6",sx:{fontWeight:700,color:"#FFD600",mb:3},children:"\uD83D\uDDA5️ System Status"}),V?(0,r.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,r.jsx)(h.A,{size:20,sx:{color:"#FFD600"}}),(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0"},children:"Checking system status..."})]}):(0,r.jsxs)(p.Ay,{container:!0,spacing:2,children:[(0,r.jsx)(p.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsxs)(s.A,{sx:{mb:2},children:[(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"Database Status:"}),(0,r.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)(s.A,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:R.supabaseConnected?"#4CAF50":"#F44336",animation:R.supabaseConnected?"pulse 2s infinite":"none","@keyframes pulse":{"0%":{opacity:1},"50%":{opacity:.5},"100%":{opacity:1}}}}),(0,r.jsx)(n.A,{variant:"body1",sx:{color:R.supabaseConnected?"#4CAF50":"#F44336",fontWeight:600},children:R.supabaseConnected?"Connected":"Disconnected"})]})]})}),(0,r.jsx)(p.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsxs)(s.A,{sx:{mb:2},children:[(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"API Status:"}),(0,r.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)(s.A,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:R.backendConnected?"#4CAF50":"#F44336",animation:R.backendConnected?"pulse 2s infinite":"none","@keyframes pulse":{"0%":{opacity:1},"50%":{opacity:.5},"100%":{opacity:1}}}}),(0,r.jsx)(n.A,{variant:"body1",sx:{color:R.backendConnected?"#4CAF50":"#F44336",fontWeight:600},children:R.backendConnected?"Operational":"Disconnected"})]})]})}),(0,r.jsx)(p.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsxs)(s.A,{sx:{mb:2},children:[(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"Last Checked:"}),(0,r.jsx)(n.A,{variant:"body1",sx:{color:"#FFF",fontWeight:600},children:R.lastChecked?new Date(R.lastChecked).toLocaleTimeString():"Never"})]})}),(0,r.jsx)(p.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,r.jsxs)(s.A,{sx:{mb:2},children:[(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"Version:"}),(0,r.jsx)(n.A,{variant:"body1",sx:{color:"#FFF",fontWeight:600},children:(null==q?void 0:q.version)||"1.0.0"})]})})]}),(0,r.jsx)(s.A,{sx:{mt:2},children:(0,r.jsx)(c.A,{variant:"outlined",onClick:eh,disabled:V,sx:{borderColor:"#FFD600",color:"#FFD600","&:hover":{borderColor:"#F9A825",backgroundColor:"#FFD60020"}},children:V?"Refreshing...":"Refresh Status"})})]}),(0,r.jsxs)(l.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",p:3,mb:3},children:[(0,r.jsx)(n.A,{variant:"h6",sx:{fontWeight:700,color:"#FFD600",mb:3},children:"\uD83D\uDD17 Suricata Integration"}),(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:3},children:"Configure eve.json file processing"}),(0,r.jsxs)(s.A,{sx:{mb:4},children:[(0,r.jsx)(n.A,{variant:"subtitle1",sx:{fontWeight:600,color:"#FFD600",mb:2},children:"\uD83D\uDCC4 EVE JSON Configuration"}),(0,r.jsxs)(p.Ay,{container:!0,spacing:3,children:[(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsx)(u.A,{label:"EVE JSON File Path",value:eo.eveJsonPath,onChange:e=>es({...eo,eveJsonPath:e.target.value}),fullWidth:!0,placeholder:"/var/log/suricata/eve.json",helperText:"Path to your Suricata eve.json log file",sx:{"& .MuiOutlinedInput-root":{color:"#FFF","& fieldset":{borderColor:"#2B2B2B"}},"& .MuiFormHelperText-root":{color:"#B0B0B0"}},InputProps:{endAdornment:(0,r.jsx)(c.A,{size:"small",onClick:()=>{let e=document.createElement("input");e.type="file",e.accept=".json",e.style.display="none",e.onchange=e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&ev("File Selected","Selected file: ".concat(a.name),"warning","Please enter the full server path to the EVE JSON file in the text field above. Due to browser security restrictions, we cannot access the full file path.")},document.body.appendChild(e),e.click(),document.body.removeChild(e)},sx:{color:"#FFD600",fontWeight:600,fontSize:"0.75rem",minWidth:"auto",px:1.5,"&:hover":{backgroundColor:"#FFD60020"}},children:"Browse"})}})}),(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsx)(g.A,{control:(0,r.jsx)(x.A,{checked:eo.autoReload,onChange:e=>es({...eo,autoReload:e.target.checked}),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#FFD600"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#FFD600"}}}),label:(0,r.jsxs)(s.A,{children:[(0,r.jsx)(n.A,{variant:"body1",sx:{color:"#FFF",fontWeight:600},children:"Auto-Reload on Changes"}),(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",fontSize:"0.875rem"},children:"Automatically process new alerts"})]})})})]}),(0,r.jsx)(s.A,{sx:{mt:3,display:"flex",gap:2,flexWrap:"wrap"},children:(0,r.jsx)(c.A,{variant:"outlined",onClick:eb,disabled:en,sx:{borderColor:"#4CAF50",color:"#4CAF50",fontWeight:700,"&:hover":{borderColor:"#45A049",backgroundColor:"#4CAF5020"}},children:en?"Saving...":"\uD83D\uDCBE Save Configuration"})})]})]}),(0,r.jsxs)(l.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",p:3,mb:3},children:[(0,r.jsx)(n.A,{variant:"h6",sx:{fontWeight:700,color:"#FFD600",mb:3},children:"Dashboard Preferences"}),(0,r.jsxs)(p.Ay,{container:!0,spacing:3,children:[(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsx)(g.A,{control:(0,r.jsx)(x.A,{checked:E.autoRefresh,onChange:e=>eF("autoRefresh",e.target.checked),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#FFD600"}}}),label:"Auto-refresh Dashboard"})}),(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsx)(u.A,{label:"Refresh Interval (seconds)",type:"number",value:E.refreshInterval,onChange:e=>eF("refreshInterval",parseInt(e.target.value,10)),fullWidth:!0,disabled:!E.autoRefresh,sx:{"& .MuiOutlinedInput-root":{color:"#FFF","& fieldset":{borderColor:"#2B2B2B"}}}})}),(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsxs)(u.A,{label:"Alert Threshold",select:!0,value:E.alertThreshold,onChange:e=>eF("alertThreshold",e.target.value),fullWidth:!0,SelectProps:{native:!0},sx:{"& .MuiOutlinedInput-root":{color:"#FFF","& fieldset":{borderColor:"#2B2B2B"}}},children:[(0,r.jsx)("option",{value:"Critical",children:"Critical Only"}),(0,r.jsx)("option",{value:"High",children:"High and Above"}),(0,r.jsx)("option",{value:"Medium",children:"Medium and Above"}),(0,r.jsx)("option",{value:"Low",children:"All Alerts"})]})})]}),(0,r.jsx)(d.A,{sx:{borderColor:"#2B2B2B",my:3}}),(0,r.jsx)(n.A,{variant:"h6",sx:{fontWeight:700,color:"#FFD600",mb:2},children:"Notifications"}),(0,r.jsxs)(p.Ay,{container:!0,spacing:3,children:[(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsx)(g.A,{control:(0,r.jsx)(x.A,{checked:E.emailNotifications,onChange:e=>eF("emailNotifications",e.target.checked),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#FFD600"}}}),label:"Email Notifications"})}),E.emailNotifications&&(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsx)(u.A,{label:"Email Address",type:"email",value:E.emailAddress,onChange:e=>eF("emailAddress",e.target.value),fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{color:"#FFF","& fieldset":{borderColor:"#2B2B2B"}}}})}),(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsx)(g.A,{control:(0,r.jsx)(x.A,{checked:E.slackNotifications,onChange:e=>eF("slackNotifications",e.target.checked),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#FFD600"}}}),label:"Slack Notifications"})}),E.slackNotifications&&(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsx)(u.A,{label:"Slack Webhook URL",value:E.slackWebhook,onChange:e=>eF("slackWebhook",e.target.value),fullWidth:!0,type:"password",sx:{"& .MuiOutlinedInput-root":{color:"#FFF","& fieldset":{borderColor:"#2B2B2B"}}}})})]}),(0,r.jsxs)(s.A,{sx:{mt:3,display:"flex",gap:2,flexWrap:"wrap"},children:[(0,r.jsx)(c.A,{variant:"contained",sx:{backgroundColor:"#FFD600",color:"#000",fontWeight:700},onClick:ej,children:"Save Settings"}),(0,r.jsx)(c.A,{variant:"outlined",sx:{borderColor:"#4CAF50",color:"#4CAF50",fontWeight:700},onClick:()=>{let e=JSON.stringify(E,null,2),t="data:application/json;charset=utf-8,".concat(encodeURIComponent(e)),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download","dashboard-settings.json"),a.click()},children:"Export Settings"}),(0,r.jsxs)(c.A,{variant:"outlined",component:"label",sx:{borderColor:"#2196F3",color:"#2196F3",fontWeight:700},children:["Import Settings",(0,r.jsx)("input",{type:"file",accept:".json",hidden:!0,onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(!a)return;let r=new FileReader;r.onload=e=>{try{var t;let a=JSON.parse(null==(t=e.target)?void 0:t.result);P(e=>({...e,...a})),T(!1),H("Settings imported successfully!"),setTimeout(()=>H(null),3e3)}catch(e){H("Failed to import settings. Invalid file format."),setTimeout(()=>H(null),3e3)}},r.readAsText(a)}})]}),(0,r.jsx)(c.A,{variant:"outlined",sx:{borderColor:"#FF9800",color:"#FF9800",fontWeight:700},onClick:()=>{confirm("Are you sure you want to reset all settings to default values?")&&(P({autoRefresh:!0,refreshInterval:30,alertThreshold:"Medium",emailNotifications:!0,emailAddress:"admin@example.com",slackNotifications:!1,slackWebhook:""}),T(!1),H("Settings reset to default values!"),setTimeout(()=>H(null),3e3))},children:"Reset to Default"})]})]}),(0,r.jsxs)(l.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",p:3,mb:3},children:[(0,r.jsx)(n.A,{variant:"h6",sx:{fontWeight:700,color:"#FFD600",mb:3},children:"\uD83D\uDDC4️ Database"}),(0,r.jsx)(c.A,{variant:"outlined",fullWidth:!0,sx:{borderColor:"#FFD600",color:"#FFD600",fontWeight:700,mb:2,"&:hover":{borderColor:"#FFD600",backgroundColor:"#FFD60020"}},onClick:ek,children:"\uD83D\uDD0D Test Connection"})]}),(0,r.jsxs)(l.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",p:3},children:[(0,r.jsx)(n.A,{variant:"h6",sx:{fontWeight:700,color:"#FFD600",mb:3},children:"ℹ️ About"}),(0,r.jsxs)(p.Ay,{container:!0,spacing:2,children:[(0,r.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,r.jsxs)(s.A,{sx:{mb:2},children:[(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"App Name:"}),(0,r.jsx)(n.A,{variant:"body1",sx:{color:"#FFF",fontWeight:600},children:"Matseka Suricata"})]})}),(0,r.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,r.jsxs)(s.A,{sx:{mb:2},children:[(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"Version:"}),(0,r.jsx)(n.A,{variant:"body1",sx:{color:"#FFF",fontWeight:600},children:"1.0.0"})]})}),(0,r.jsx)(p.Ay,{item:!0,xs:12,children:(0,r.jsxs)(s.A,{sx:{mb:2},children:[(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mb:.5},children:"Description:"}),(0,r.jsx)(n.A,{variant:"body1",sx:{color:"#FFF",fontWeight:600},children:"Network Intrusion Detection System Dashboard"})]})})]})]})]}),(0,r.jsxs)(m.A,{open:el.open,maxWidth:"sm",fullWidth:!0,disableEscapeKeyDown:!0,children:[(0,r.jsx)(b.A,{sx:{color:"#FFD600",fontWeight:700,backgroundColor:"#1A1A1A"},children:el.title}),(0,r.jsx)(A.A,{sx:{backgroundColor:"#1A1A1A"},children:(0,r.jsxs)(s.A,{sx:{textAlign:"center",py:2},children:[(0,r.jsx)(h.A,{sx:{color:"#FFD600",mb:2}}),(0,r.jsx)(n.A,{variant:"body1",sx:{color:"#E0E0E0",mb:2},children:el.message}),el.showProgress&&(0,r.jsxs)(s.A,{sx:{width:"100%",mb:2},children:[(0,r.jsx)(f.A,{variant:"determinate",value:el.progress,sx:{backgroundColor:"#2B2B2B","& .MuiLinearProgress-bar":{backgroundColor:"#FFD600"}}}),(0,r.jsxs)(n.A,{variant:"body2",sx:{color:"#B0B0B0",mt:1},children:[el.progress,"%"]})]})]})})]}),(0,r.jsxs)(m.A,{open:ed.open,maxWidth:"sm",fullWidth:!0,children:[(0,r.jsx)(b.A,{sx:{color:"success"===ed.type?"#4CAF50":"error"===ed.type?"#F44336":"#FF9800",fontWeight:700,backgroundColor:"#1A1A1A"},children:ed.title}),(0,r.jsx)(A.A,{sx:{backgroundColor:"#1A1A1A"},children:(0,r.jsxs)(s.A,{sx:{py:2},children:[(0,r.jsx)(n.A,{variant:"body1",sx:{color:"#E0E0E0",mb:2},children:ed.message}),ed.details&&(0,r.jsx)(s.A,{sx:{backgroundColor:"#1A1A1A",border:"1px solid #2B2B2B",borderRadius:1,p:2,mb:2},children:(0,r.jsx)(n.A,{variant:"body2",sx:{color:"#B0B0B0",whiteSpace:"pre-line",fontFamily:"monospace",fontSize:"0.875rem"},children:ed.details})}),(0,r.jsx)(s.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,r.jsx)(y.A,{label:ed.type.toUpperCase(),size:"small",sx:{backgroundColor:"success"===ed.type?"#4CAF50":"error"===ed.type?"#F44336":"#FF9800",color:"#FFF",fontWeight:700}})})]})}),(0,r.jsx)(v.A,{sx:{backgroundColor:"#1A1A1A"},children:"warning"===ed.type?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.A,{onClick:eC,sx:{color:"#B0B0B0"},children:"Cancel"}),(0,r.jsx)(c.A,{onClick:ed.title.includes("Clear Alerts")?ew:ed.title.includes("Clear Cache")?()=>{eC();try{localStorage.clear(),a(),ev("Cache Cleared","All cached data has been cleared successfully!","success","You may need to reconfigure your database connection and log in again.")}catch(e){ev("Clear Error","Failed to clear cache","error","Error: ".concat(e.message||"Unknown error occurred"))}}:eS,variant:"contained",sx:{backgroundColor:ed.title.includes("Clear Alerts")||ed.title.includes("Clear Cache")?"#F44336":"#FF9800",color:"#FFF",fontWeight:700},children:"Confirm"})]}):(0,r.jsx)(c.A,{onClick:eC,variant:"contained",sx:{backgroundColor:"success"===ed.type?"#4CAF50":"#F44336",color:"#FFF",fontWeight:700},children:"OK"})})]})]})})}}},e=>{e.O(0,[256,799,125,667,672,946,368,441,255,358],()=>e(e.s=14256)),_N_E=e.O()}]);